{
  "convex._generated.dataModel.d.DataModel": {
    "id": "convex._generated.dataModel.d.DataModel",
    "name": "DataModel",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/_generated/dataModel.d.ts",
    "relative_path": "convex/_generated/dataModel.d.ts",
    "depends_on": [
      "convex._generated.dataModel.d.Id"
    ],
    "source_code": "type DataModel = {\n  agent_runs: {\n    document: {\n      agent?: string;\n      agentName?: \"main\" | \"assessment\" | \"crisis\";\n      budgetResult?: any;\n      createdAt?: number;\n      latencyMs?: number;\n      policyBundle?: string;\n      threadId?: string;\n      toolCalls?: Array<any>;\n      traceId?: string;\n      userId: Id<\"users\">;\n      _id: Id<\"agent_runs\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"agent\"\n      | \"agentName\"\n      | \"budgetResult\"\n      | \"createdAt\"\n      | \"latencyMs\"\n      | \"policyBundle\"\n      | \"threadId\"\n      | \"toolCalls\"\n      | \"traceId\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  alerts: {\n    document: {\n      channel: \"sms\" | \"email\";\n      context: any;\n      message: string;\n      severity: \"low\" | \"medium\" | \"high\" | \"critical\";\n      status: \"pending\" | \"processed\";\n      type: string;\n      userId: Id<\"users\">;\n      _id: Id<\"alerts\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"channel\"\n      | \"context\"\n      | \"message\"\n      | \"severity\"\n      | \"status\"\n      | \"type\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_severity: [\"severity\", \"_creationTime\"];\n      by_type: [\"type\", \"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  assessment_sessions: {\n    document: {\n      answers: Array<{ questionId: string; value: number }>;\n      channel: \"sms\" | \"web\";\n      definitionId: string;\n      questionIndex: number;\n      status: \"active\" | \"completed\";\n      userId: Id<\"users\">;\n      _id: Id<\"assessment_sessions\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"answers\"\n      | \"channel\"\n      | \"definitionId\"\n      | \"questionIndex\"\n      | \"status\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_user_and_type: [\"userId\", \"definitionId\", \"_creationTime\"];\n      by_user_status: [\"userId\", \"status\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  assessments: {\n    document: {\n      answers: Array<{ questionId: string; value: number }>;\n      completedAt: number;\n      definitionId: \"ema\" | \"sdoh\";\n      rawScores?: any;\n      userId: Id<\"users\">;\n      version: string;\n      _id: Id<\"assessments\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"answers\"\n      | \"completedAt\"\n      | \"definitionId\"\n      | \"rawScores\"\n      | \"userId\"\n      | \"version\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n      by_user_and_type: [\"userId\", \"definitionId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  authAccounts: {\n    document: {\n      emailVerified?: string;\n      phoneVerified?: string;\n      provider: string;\n      providerAccountId: string;\n      secret?: string;\n      userId: Id<\"users\">;\n      _id: Id<\"authAccounts\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"emailVerified\"\n      | \"phoneVerified\"\n      | \"provider\"\n      | \"providerAccountId\"\n      | \"secret\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      providerAndAccountId: [\"provider\", \"providerAccountId\", \"_creationTime\"];\n      userIdAndProvider: [\"userId\", \"provider\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  authRateLimits: {\n    document: {\n      attemptsLeft: number;\n      identifier: string;\n      lastAttemptTime: number;\n      _id: Id<\"authRateLimits\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"attemptsLeft\"\n      | \"identifier\"\n      | \"lastAttemptTime\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      identifier: [\"identifier\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  authRefreshTokens: {\n    document: {\n      expirationTime: number;\n      firstUsedTime?: number;\n      parentRefreshTokenId?: Id<\"authRefreshTokens\">;\n      sessionId: Id<\"authSessions\">;\n      _id: Id<\"authRefreshTokens\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"expirationTime\"\n      | \"firstUsedTime\"\n      | \"parentRefreshTokenId\"\n      | \"sessionId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      sessionId: [\"sessionId\", \"_creationTime\"];\n      sessionIdAndParentRefreshTokenId: [\n        \"sessionId\",\n        \"parentRefreshTokenId\",\n        \"_creationTime\",\n      ];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  authSessions: {\n    document: {\n      expirationTime: number;\n      userId: Id<\"users\">;\n      _id: Id<\"authSessions\">;\n      _creationTime: number;\n    };\n    fieldPaths: \"_creationTime\" | \"_id\" | \"expirationTime\" | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      userId: [\"userId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  authVerificationCodes: {\n    document: {\n      accountId: Id<\"authAccounts\">;\n      code: string;\n      emailVerified?: string;\n      expirationTime: number;\n      phoneVerified?: string;\n      provider: string;\n      verifier?: string;\n      _id: Id<\"authVerificationCodes\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"accountId\"\n      | \"code\"\n      | \"emailVerified\"\n      | \"expirationTime\"\n      | \"phoneVerified\"\n      | \"provider\"\n      | \"verifier\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      accountId: [\"accountId\", \"_creationTime\"];\n      code: [\"code\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  authVerifiers: {\n    document: {\n      sessionId?: Id<\"authSessions\">;\n      signature?: string;\n      _id: Id<\"authVerifiers\">;\n      _creationTime: number;\n    };\n    fieldPaths: \"_creationTime\" | \"_id\" | \"sessionId\" | \"signature\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      signature: [\"signature\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  billing_events: {\n    document: {\n      data: any;\n      stripeEventId: string;\n      type: string;\n      userId?: Id<\"users\">;\n      _id: Id<\"billing_events\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"data\"\n      | \"stripeEventId\"\n      | \"type\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_event: [\"stripeEventId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  conversation_feedback: {\n    document: {\n      agentRunId?: Id<\"agent_runs\">;\n      alertId?: Id<\"alerts\">;\n      createdAt: number;\n      helpful: boolean;\n      reason?: string;\n      userId: Id<\"users\">;\n      _id: Id<\"conversation_feedback\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"agentRunId\"\n      | \"alertId\"\n      | \"createdAt\"\n      | \"helpful\"\n      | \"reason\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_alert: [\"alertId\", \"_creationTime\"];\n      by_helpful: [\"helpful\", \"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  crisis_feedback: {\n    document: {\n      alertId: Id<\"alerts\">;\n      connectedWith988?: boolean;\n      createdAt: number;\n      followUpResponse?: string;\n      userId: Id<\"users\">;\n      wasHelpful?: boolean;\n      _id: Id<\"crisis_feedback\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"alertId\"\n      | \"connectedWith988\"\n      | \"createdAt\"\n      | \"followUpResponse\"\n      | \"userId\"\n      | \"wasHelpful\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_alert: [\"alertId\", \"_creationTime\"];\n      by_connected: [\"connectedWith988\", \"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  entitlements: {\n    document: {\n      active: boolean;\n      expiresAt?: number;\n      feature: string;\n      userId: Id<\"users\">;\n      _id: Id<\"entitlements\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"active\"\n      | \"expiresAt\"\n      | \"feature\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_user_feature: [\"userId\", \"feature\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  events: {\n    document: {\n      payload:\n        | { helpful: boolean; resourceId: string; timestamp: number }\n        | { query?: string; timestamp?: number; zip?: string; zone?: string }\n        | {\n            band?: string;\n            completedAt?: number;\n            definitionId?: string;\n            score?: number;\n          }\n        | { fields?: Array<string>; timestamp?: number }\n        | {\n            category?: string;\n            importance?: number;\n            memoryId?: Id<\"memories\">;\n            timestamp?: number;\n          }\n        | {\n            assessmentId?: Id<\"assessments\">;\n            band?: string;\n            completedAt?: number;\n            gcBurnout?: number;\n          }\n        | { context?: string; reason: \"missing_phone\"; timestamp: number };\n      type:\n        | \"intervention.try\"\n        | \"intervention.success\"\n        | \"intervention.skip\"\n        | \"resource.open\"\n        | \"resource.search\"\n        | \"assessment.completed\"\n        | \"assessment.started\"\n        | \"profile.updated\"\n        | \"memory.recorded\"\n        | \"check_in.completed\"\n        | \"sms.missing_phone\";\n      userId: Id<\"users\">;\n      _id: Id<\"events\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"payload\"\n      | \"payload.assessmentId\"\n      | \"payload.band\"\n      | \"payload.category\"\n      | \"payload.completedAt\"\n      | \"payload.context\"\n      | \"payload.definitionId\"\n      | \"payload.fields\"\n      | \"payload.gcBurnout\"\n      | \"payload.helpful\"\n      | \"payload.importance\"\n      | \"payload.memoryId\"\n      | \"payload.query\"\n      | \"payload.reason\"\n      | \"payload.resourceId\"\n      | \"payload.score\"\n      | \"payload.timestamp\"\n      | \"payload.zip\"\n      | \"payload.zone\"\n      | \"type\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_type: [\"type\", \"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  guardrail_events: {\n    document: {\n      context: any;\n      createdAt: number;\n      severity: \"low\" | \"medium\" | \"high\";\n      type:\n        | \"crisis\"\n        | \"false_positive\"\n        | \"dv_hint\"\n        | \"crisis_followup_sent\"\n        | \"stress_spike_followup_sent\"\n        | \"reassurance_loop\"\n        | \"self_sacrifice\";\n      userId?: Id<\"users\">;\n      _id: Id<\"guardrail_events\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"context\"\n      | \"createdAt\"\n      | \"severity\"\n      | \"type\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_severity: [\"severity\", \"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n      by_user_createdAt: [\"userId\", \"createdAt\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  inbound_receipts: {\n    document: {\n      messageSid: string;\n      receivedAt?: number;\n      userId?: Id<\"users\">;\n      _id: Id<\"inbound_receipts\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"messageSid\"\n      | \"receivedAt\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_messageSid: [\"messageSid\", \"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  intervention_events: {\n    document: {\n      interventionId: string;\n      metadata?: any;\n      status: string;\n      userId: Id<\"users\">;\n      _id: Id<\"intervention_events\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"interventionId\"\n      | \"metadata\"\n      | \"status\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  intervention_zones: {\n    document: {\n      interventionId: Id<\"interventions\">;\n      zone: string;\n      _id: Id<\"intervention_zones\">;\n      _creationTime: number;\n    };\n    fieldPaths: \"_creationTime\" | \"_id\" | \"interventionId\" | \"zone\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_intervention: [\"interventionId\", \"_creationTime\"];\n      by_zone: [\"zone\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  interventions: {\n    document: {\n      category: string;\n      content: string;\n      description: string;\n      duration: string;\n      evidenceLevel: \"high\" | \"moderate\" | \"low\";\n      tags: Array<string>;\n      targetZones: Array<string>;\n      title: string;\n      _id: Id<\"interventions\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"category\"\n      | \"content\"\n      | \"description\"\n      | \"duration\"\n      | \"evidenceLevel\"\n      | \"tags\"\n      | \"targetZones\"\n      | \"title\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_category: [\"category\", \"_creationTime\"];\n      by_evidence: [\"evidenceLevel\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  llm_usage: {\n    document: {\n      agentName?: \"main\" | \"assessment\" | \"crisis\";\n      completionTokens: number;\n      createdAt: number;\n      model: string;\n      promptTokens: number;\n      provider: string;\n      totalTokens: number;\n      userId?: Id<\"users\">;\n      _id: Id<\"llm_usage\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"agentName\"\n      | \"completionTokens\"\n      | \"createdAt\"\n      | \"model\"\n      | \"promptTokens\"\n      | \"provider\"\n      | \"totalTokens\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_created: [\"createdAt\", \"_creationTime\"];\n      by_user_created: [\"userId\", \"createdAt\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  memories: {\n    document: {\n      category:\n        | \"care_routine\"\n        | \"preference\"\n        | \"intervention_result\"\n        | \"crisis_trigger\"\n        | \"family_health\";\n      content: string;\n      importance: number;\n      userId: Id<\"users\">;\n      _id: Id<\"memories\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"category\"\n      | \"content\"\n      | \"importance\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_user_and_importance: [\"userId\", \"importance\", \"_creationTime\"];\n      by_user_category: [\"userId\", \"category\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  prompt_versions: {\n    document: {\n      createdAt: number;\n      name: string;\n      prompt: string;\n      version: string;\n      _id: Id<\"prompt_versions\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"createdAt\"\n      | \"name\"\n      | \"prompt\"\n      | \"version\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_name_version: [\"name\", \"version\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  resource_cache: {\n    document: {\n      category: string;\n      createdAt: number;\n      expiresAt?: number;\n      placeIds?: Array<string>;\n      results?: any;\n      zip: string;\n      _id: Id<\"resource_cache\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"category\"\n      | \"createdAt\"\n      | \"expiresAt\"\n      | \"placeIds\"\n      | \"results\"\n      | \"zip\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_expiresAt: [\"expiresAt\", \"_creationTime\"];\n      by_zip_cat: [\"zip\", \"category\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  score_history: {\n    document: {\n      newScore: number;\n      oldScore: number;\n      timestamp: number;\n      trigger: \"ema\" | \"sdoh\" | \"observation\";\n      userId: Id<\"users\">;\n      zones: {\n        P1?: number;\n        P2?: number;\n        P3?: number;\n        P4?: number;\n        P5?: number;\n        P6?: number;\n      };\n      _id: Id<\"score_history\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"newScore\"\n      | \"oldScore\"\n      | \"timestamp\"\n      | \"trigger\"\n      | \"userId\"\n      | \"zones\"\n      | \"zones.P1\"\n      | \"zones.P2\"\n      | \"zones.P3\"\n      | \"zones.P4\"\n      | \"zones.P5\"\n      | \"zones.P6\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_timestamp: [\"timestamp\", \"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  scores: {\n    document: {\n      answeredRatio: number;\n      assessmentId: Id<\"assessments\">;\n      band: \"very_low\" | \"low\" | \"moderate\" | \"high\";\n      confidence: number;\n      gcBurnout: number;\n      instrument: \"ema\" | \"sdoh\";\n      rawComposite: number;\n      userId: Id<\"users\">;\n      zones: {\n        P1?: number;\n        P2?: number;\n        P3?: number;\n        P4?: number;\n        P5?: number;\n        P6?: number;\n      };\n      _id: Id<\"scores\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"answeredRatio\"\n      | \"assessmentId\"\n      | \"band\"\n      | \"confidence\"\n      | \"gcBurnout\"\n      | \"instrument\"\n      | \"rawComposite\"\n      | \"userId\"\n      | \"zones\"\n      | \"zones.P1\"\n      | \"zones.P2\"\n      | \"zones.P3\"\n      | \"zones.P4\"\n      | \"zones.P5\"\n      | \"zones.P6\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n      by_user_and_assessment: [\"userId\", \"assessmentId\", \"_creationTime\"];\n      by_user_and_type: [\"userId\", \"instrument\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  scores_composite: {\n    document: {\n      band: string;\n      gcBurnout: number;\n      userId: Id<\"users\">;\n      _id: Id<\"scores_composite\">;\n      _creationTime: number;\n    };\n    fieldPaths: \"_creationTime\" | \"_id\" | \"band\" | \"gcBurnout\" | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  session_metrics: {\n    document: {\n      assessmentCompleted?: boolean;\n      avgResponseTimeMs?: number;\n      crisisDetected?: boolean;\n      endedAt?: number;\n      messageCount: number;\n      startedAt: number;\n      threadId?: string;\n      userId: Id<\"users\">;\n      userReturnedNext24h?: boolean;\n      _id: Id<\"session_metrics\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"assessmentCompleted\"\n      | \"avgResponseTimeMs\"\n      | \"crisisDetected\"\n      | \"endedAt\"\n      | \"messageCount\"\n      | \"startedAt\"\n      | \"threadId\"\n      | \"userId\"\n      | \"userReturnedNext24h\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_started: [\"startedAt\", \"_creationTime\"];\n      by_thread: [\"threadId\", \"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  subscriptions: {\n    document: {\n      canceledAt?: number;\n      currentPeriodEnd: number;\n      gracePeriodEndsAt?: number;\n      planId: \"monthly\" | \"annual\";\n      status: \"active\" | \"canceled\" | \"past_due\";\n      stripeCustomerId: string;\n      userId: Id<\"users\">;\n      _id: Id<\"subscriptions\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"canceledAt\"\n      | \"currentPeriodEnd\"\n      | \"gracePeriodEndsAt\"\n      | \"planId\"\n      | \"status\"\n      | \"stripeCustomerId\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_customer: [\"stripeCustomerId\", \"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n      by_user_status: [\"userId\", \"status\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  tool_calls: {\n    document: {\n      agentName?: string;\n      cost?: number;\n      createdAt: number;\n      durationMs?: number;\n      name: string;\n      success: boolean;\n      userId?: Id<\"users\">;\n      _id: Id<\"tool_calls\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"agentName\"\n      | \"cost\"\n      | \"createdAt\"\n      | \"durationMs\"\n      | \"name\"\n      | \"success\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_name: [\"name\", \"_creationTime\"];\n      by_user_created: [\"userId\", \"createdAt\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  triggers: {\n    document: {\n      nextRun: number;\n      payload: any;\n      rrule: string;\n      status: \"active\" | \"paused\";\n      timezone: string;\n      type: \"recurring\" | \"one_off\";\n      userExternalId: string;\n      userId: Id<\"users\">;\n      _id: Id<\"triggers\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"nextRun\"\n      | \"payload\"\n      | \"rrule\"\n      | \"status\"\n      | \"timezone\"\n      | \"type\"\n      | \"userExternalId\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_nextRun: [\"nextRun\", \"_creationTime\"];\n      by_user: [\"userId\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  usage_invoices: {\n    document: {\n      billingPeriod: string;\n      status: \"open\" | \"paid\" | \"void\";\n      totalCost: number;\n      totalTokens: number;\n      userId: Id<\"users\">;\n      _id: Id<\"usage_invoices\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"billingPeriod\"\n      | \"status\"\n      | \"totalCost\"\n      | \"totalTokens\"\n      | \"userId\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_user_period: [\"userId\", \"billingPeriod\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  users: {\n    document: {\n      address?: {\n        city?: string;\n        country?: string;\n        line1?: string;\n        postalCode?: string;\n        state?: string;\n      };\n      channel?: \"sms\" | \"email\" | \"web\";\n      consent?: { emergency: boolean; marketing: boolean };\n      emaEnabled?: boolean;\n      email?: string;\n      externalId: string;\n      gcSdohScore?: number;\n      lastEMA?: number;\n      lastEngagementDate?: number;\n      lastSDOH?: number;\n      locale?: string;\n      metadata?: {\n        awaitingCrisisFollowUp?: { alertId: Id<\"alerts\">; timestamp: number };\n        careRecipient?: string;\n        careRecipientName?: string;\n        checkInFrequency?: \"daily\" | \"weekly\";\n        checkInTime?: string;\n        contextUpdatedAt?: number;\n        convex?: any;\n        enrichedContext?: string;\n        firstAssessmentCompletedAt?: number;\n        firstBand?: string;\n        firstName?: string;\n        firstResourceSearchedAt?: number;\n        firstScore?: number;\n        gcBurnout?: number;\n        gcSdohScore?: number;\n        journeyPhase?: string;\n        lastAssessmentScore?: number;\n        lastEMA?: number;\n        lastSDOH?: number;\n        lastSpikeFollowUpAt?: number;\n        latitude?: number;\n        longitude?: number;\n        onboardingCompletedAt?: number;\n        onboardingMilestones?: Array<{\n          completedAt: number;\n          milestone: string;\n        }>;\n        onboardingStage?: string;\n        primaryStressor?: string;\n        proactiveOk?: boolean;\n        profile?: {\n          careRecipientName?: string;\n          firstName?: string;\n          relationship?: string;\n        };\n        reassuranceLoopFlag?: boolean;\n        riskLevel?: \"low\" | \"moderate\" | \"high\" | \"crisis\";\n        snoozeUntil?: number;\n        threadId?: string;\n        timezone?: string;\n        totalInteractionCount?: number;\n        zipCode?: string;\n        zones?: {\n          P1?: number;\n          P2?: number;\n          P3?: number;\n          P4?: number;\n          P5?: number;\n          P6?: number;\n        };\n      };\n      name?: string;\n      phone?: string;\n      riskLevel?: \"low\" | \"moderate\" | \"high\" | \"crisis\";\n      zipCode?: string;\n      zones?: {\n        P1?: number;\n        P2?: number;\n        P3?: number;\n        P4?: number;\n        P5?: number;\n        P6?: number;\n      };\n      _id: Id<\"users\">;\n      _creationTime: number;\n    };\n    fieldPaths:\n      | \"_creationTime\"\n      | \"_id\"\n      | \"address\"\n      | \"address.city\"\n      | \"address.country\"\n      | \"address.line1\"\n      | \"address.postalCode\"\n      | \"address.state\"\n      | \"channel\"\n      | \"consent\"\n      | \"consent.emergency\"\n      | \"consent.marketing\"\n      | \"emaEnabled\"\n      | \"email\"\n      | \"externalId\"\n      | \"gcSdohScore\"\n      | \"lastEMA\"\n      | \"lastEngagementDate\"\n      | \"lastSDOH\"\n      | \"locale\"\n      | \"metadata\"\n      | \"metadata.awaitingCrisisFollowUp\"\n      | \"metadata.awaitingCrisisFollowUp.alertId\"\n      | \"metadata.awaitingCrisisFollowUp.timestamp\"\n      | \"metadata.careRecipient\"\n      | \"metadata.careRecipientName\"\n      | \"metadata.checkInFrequency\"\n      | \"metadata.checkInTime\"\n      | \"metadata.contextUpdatedAt\"\n      | \"metadata.convex\"\n      | \"metadata.enrichedContext\"\n      | \"metadata.firstAssessmentCompletedAt\"\n      | \"metadata.firstBand\"\n      | \"metadata.firstName\"\n      | \"metadata.firstResourceSearchedAt\"\n      | \"metadata.firstScore\"\n      | \"metadata.gcBurnout\"\n      | \"metadata.gcSdohScore\"\n      | \"metadata.journeyPhase\"\n      | \"metadata.lastAssessmentScore\"\n      | \"metadata.lastEMA\"\n      | \"metadata.lastSDOH\"\n      | \"metadata.lastSpikeFollowUpAt\"\n      | \"metadata.latitude\"\n      | \"metadata.longitude\"\n      | \"metadata.onboardingCompletedAt\"\n      | \"metadata.onboardingMilestones\"\n      | \"metadata.onboardingStage\"\n      | \"metadata.primaryStressor\"\n      | \"metadata.proactiveOk\"\n      | \"metadata.profile\"\n      | \"metadata.profile.careRecipientName\"\n      | \"metadata.profile.firstName\"\n      | \"metadata.profile.relationship\"\n      | \"metadata.reassuranceLoopFlag\"\n      | \"metadata.riskLevel\"\n      | \"metadata.snoozeUntil\"\n      | \"metadata.threadId\"\n      | \"metadata.timezone\"\n      | \"metadata.totalInteractionCount\"\n      | \"metadata.zipCode\"\n      | \"metadata.zones\"\n      | \"metadata.zones.P1\"\n      | \"metadata.zones.P2\"\n      | \"metadata.zones.P3\"\n      | \"metadata.zones.P4\"\n      | \"metadata.zones.P5\"\n      | \"metadata.zones.P6\"\n      | \"name\"\n      | \"phone\"\n      | \"riskLevel\"\n      | \"zipCode\"\n      | \"zones\"\n      | \"zones.P1\"\n      | \"zones.P2\"\n      | \"zones.P3\"\n      | \"zones.P4\"\n      | \"zones.P5\"\n      | \"zones.P6\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_externalId: [\"externalId\", \"_creationTime\"];\n      by_phone: [\"phone\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n  watcher_state: {\n    document: {\n      cursor?: any;\n      lastRun?: number;\n      watcherName: string;\n      _id: Id<\"watcher_state\">;\n      _creationTime: number;\n    };\n    fieldPaths: \"_creationTime\" | \"_id\" | \"cursor\" | \"lastRun\" | \"watcherName\";\n    indexes: {\n      by_id: [\"_id\"];\n      by_creation_time: [\"_creationTime\"];\n      by_watcher: [\"watcherName\", \"_creationTime\"];\n    };\n    searchIndexes: {};\n    vectorIndexes: {};\n  };\n};",
    "start_line": 29,
    "end_line": 1187,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type DataModel",
    "component_id": "convex._generated.dataModel.d.DataModel"
  },
  "convex._generated.dataModel.d.TableNames": {
    "id": "convex._generated.dataModel.d.TableNames",
    "name": "TableNames",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/_generated/dataModel.d.ts",
    "relative_path": "convex/_generated/dataModel.d.ts",
    "depends_on": [
      "convex._generated.dataModel.d.DataModel"
    ],
    "source_code": "type TableNames = TableNamesInDataModel<DataModel>;",
    "start_line": 1192,
    "end_line": 1192,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type TableNames",
    "component_id": "convex._generated.dataModel.d.TableNames"
  },
  "convex._generated.dataModel.d.Doc": {
    "id": "convex._generated.dataModel.d.Doc",
    "name": "Doc",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/_generated/dataModel.d.ts",
    "relative_path": "convex/_generated/dataModel.d.ts",
    "depends_on": [
      "convex._generated.dataModel.d.DataModel"
    ],
    "source_code": "type Doc<TableName extends TableNames> = DocumentByName<\n  DataModel,\n  TableName\n>;",
    "start_line": 1199,
    "end_line": 1202,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type Doc",
    "component_id": "convex._generated.dataModel.d.Doc"
  },
  "convex._generated.dataModel.d.Id": {
    "id": "convex._generated.dataModel.d.Id",
    "name": "Id",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/_generated/dataModel.d.ts",
    "relative_path": "convex/_generated/dataModel.d.ts",
    "depends_on": [],
    "source_code": "type Id<TableName extends TableNames | SystemTableNames> =\n  GenericId<TableName>;",
    "start_line": 1217,
    "end_line": 1218,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type Id",
    "component_id": "convex._generated.dataModel.d.Id"
  },
  "convex._generated.server.d.QueryCtx": {
    "id": "convex._generated.server.d.QueryCtx",
    "name": "QueryCtx",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/_generated/server.d.ts",
    "relative_path": "convex/_generated/server.d.ts",
    "depends_on": [],
    "source_code": "type QueryCtx = GenericQueryCtx<DataModel>;",
    "start_line": 107,
    "end_line": 107,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type QueryCtx",
    "component_id": "convex._generated.server.d.QueryCtx"
  },
  "convex._generated.server.d.MutationCtx": {
    "id": "convex._generated.server.d.MutationCtx",
    "name": "MutationCtx",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/_generated/server.d.ts",
    "relative_path": "convex/_generated/server.d.ts",
    "depends_on": [],
    "source_code": "type MutationCtx = GenericMutationCtx<DataModel>;",
    "start_line": 115,
    "end_line": 115,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type MutationCtx",
    "component_id": "convex._generated.server.d.MutationCtx"
  },
  "convex._generated.server.d.ActionCtx": {
    "id": "convex._generated.server.d.ActionCtx",
    "name": "ActionCtx",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/_generated/server.d.ts",
    "relative_path": "convex/_generated/server.d.ts",
    "depends_on": [],
    "source_code": "type ActionCtx = GenericActionCtx<DataModel>;",
    "start_line": 123,
    "end_line": 123,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type ActionCtx",
    "component_id": "convex._generated.server.d.ActionCtx"
  },
  "convex._generated.server.d.DatabaseReader": {
    "id": "convex._generated.server.d.DatabaseReader",
    "name": "DatabaseReader",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/_generated/server.d.ts",
    "relative_path": "convex/_generated/server.d.ts",
    "depends_on": [],
    "source_code": "type DatabaseReader = GenericDatabaseReader<DataModel>;",
    "start_line": 132,
    "end_line": 132,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type DatabaseReader",
    "component_id": "convex._generated.server.d.DatabaseReader"
  },
  "convex._generated.server.d.DatabaseWriter": {
    "id": "convex._generated.server.d.DatabaseWriter",
    "name": "DatabaseWriter",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/_generated/server.d.ts",
    "relative_path": "convex/_generated/server.d.ts",
    "depends_on": [],
    "source_code": "type DatabaseWriter = GenericDatabaseWriter<DataModel>;",
    "start_line": 143,
    "end_line": 143,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type DatabaseWriter",
    "component_id": "convex._generated.server.d.DatabaseWriter"
  },
  "convex.agents.trackUsage": {
    "id": "convex.agents.trackUsage",
    "name": "trackUsage",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/agents.ts",
    "relative_path": "convex/agents.ts",
    "depends_on": [],
    "source_code": "trackUsage: UsageHandler = async (ctx, usage) => {\n  await ctx.runMutation(internal.internal.agentRuns.track, {\n    userId: usage.userId,\n    threadId: usage.threadId,\n    agentName: usage.agentName,\n    model: usage.model,\n    provider: usage.provider,\n    promptTokens: usage.usage.inputTokens ?? 0,\n    completionTokens: usage.usage.outputTokens ?? 0,\n    totalTokens: usage.usage.totalTokens ?? 0,\n    providerMetadata: usage.providerMetadata,\n  });\n}",
    "start_line": 30,
    "end_line": 42,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "usage"
    ],
    "node_type": "arrow_function",
    "base_classes": null,
    "class_name": null,
    "display_name": "arrow function trackUsage",
    "component_id": "convex.agents.trackUsage"
  },
  "convex.assessments.checkAdminAccess": {
    "id": "convex.assessments.checkAdminAccess",
    "name": "checkAdminAccess",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/assessments.ts",
    "relative_path": "convex/assessments.ts",
    "depends_on": [],
    "source_code": "async function checkAdminAccess(ctx: any): Promise<void> {\n  const identity = await ctx.auth.getUserIdentity();\n  if (!identity) {\n    throw new Error(\"Unauthorized: Authentication required\");\n  }\n\n  const email = identity.email;\n  if (!email || !ADMIN_EMAILS.includes(email)) {\n    throw new Error(\"Unauthorized: Admin access only. Contact administrator to request access.\");\n  }\n}",
    "start_line": 16,
    "end_line": 26,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function checkAdminAccess",
    "component_id": "convex.assessments.checkAdminAccess"
  },
  "convex.inbound.getUserOrCreate": {
    "id": "convex.inbound.getUserOrCreate",
    "name": "getUserOrCreate",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/inbound.ts",
    "relative_path": "convex/inbound.ts",
    "depends_on": [
      "convex.lib.utils.normalizePhone"
    ],
    "source_code": "async function getUserOrCreate(ctx: any, phoneNumber: string): Promise<any> {\n  const normalized = normalizePhone(phoneNumber);\n\n  const existing = await ctx.db\n    .query(\"users\")\n    .withIndex(\"by_phone\", (q) => q.eq(\"phone\", normalized))\n    .first();\n\n  if (existing) {\n    return existing;\n  }\n\n  const existingByExternalId = await ctx.db\n    .query(\"users\")\n    .withIndex(\"by_externalId\", (q) => q.eq(\"externalId\", normalized))\n    .first();\n\n  if (existingByExternalId) {\n    await ctx.db.patch(existingByExternalId._id, {\n      phone: normalized,\n    });\n    return await ctx.db.get(existingByExternalId._id);\n  }\n\n  const userId = await ctx.db.insert(\"users\", {\n    externalId: normalized,\n    phone: normalized,\n    channel: \"sms\",\n    locale: \"en-US\",\n    consent: {\n      emergency: true,\n      marketing: true,\n    },\n    metadata: {\n      onboardingStage: \"new\",\n      onboardingMilestones: [],\n    },\n  });\n\n  return await ctx.db.get(userId);\n}",
    "start_line": 160,
    "end_line": 200,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "phoneNumber"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function getUserOrCreate",
    "component_id": "convex.inbound.getUserOrCreate"
  },
  "convex.inbound.handleStop": {
    "id": "convex.inbound.handleStop",
    "name": "handleStop",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/inbound.ts",
    "relative_path": "convex/inbound.ts",
    "depends_on": [],
    "source_code": "async function handleStop(ctx: any, userId: any): Promise<void> {\n  const user = await ctx.db.get(userId);\n  if (user) {\n    await ctx.db.patch(userId, {\n      consent: {\n        emergency: user.consent?.emergency ?? true,\n        marketing: false,\n      },\n    });\n  }\n\n  await ctx.scheduler.runAfter(0, internal.twilioMutations.sendStopConfirmationAction, {\n    userId,\n  });\n}",
    "start_line": 205,
    "end_line": 219,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "userId"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function handleStop",
    "component_id": "convex.inbound.handleStop"
  },
  "convex.inbound.handleHelp": {
    "id": "convex.inbound.handleHelp",
    "name": "handleHelp",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/inbound.ts",
    "relative_path": "convex/inbound.ts",
    "depends_on": [],
    "source_code": "async function handleHelp(ctx: any, userId: any): Promise<void> {\n  await ctx.scheduler.runAfter(0, internal.twilioMutations.sendHelpMessageAction, {\n    userId,\n  });\n}",
    "start_line": 224,
    "end_line": 228,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "userId"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function handleHelp",
    "component_id": "convex.inbound.handleHelp"
  },
  "convex.inbound.handleSignup": {
    "id": "convex.inbound.handleSignup",
    "name": "handleSignup",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/inbound.ts",
    "relative_path": "convex/inbound.ts",
    "depends_on": [],
    "source_code": "async function handleSignup(ctx: any, userId: any): Promise<void> {\n  await ctx.scheduler.runAfter(0, internal.twilioMutations.handleResubscribeAction, {\n    userId,\n  });\n}",
    "start_line": 233,
    "end_line": 237,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "userId"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function handleSignup",
    "component_id": "convex.inbound.handleSignup"
  },
  "convex.inbound.handleResubscribe": {
    "id": "convex.inbound.handleResubscribe",
    "name": "handleResubscribe",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/inbound.ts",
    "relative_path": "convex/inbound.ts",
    "depends_on": [],
    "source_code": "async function handleResubscribe(ctx: any, userId: any): Promise<void> {\n  await ctx.scheduler.runAfter(0, internal.twilioMutations.handleResubscribeAction, {\n    userId,\n  });\n}",
    "start_line": 242,
    "end_line": 246,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "userId"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function handleResubscribe",
    "component_id": "convex.inbound.handleResubscribe"
  },
  "convex.inbound.handleBilling": {
    "id": "convex.inbound.handleBilling",
    "name": "handleBilling",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/inbound.ts",
    "relative_path": "convex/inbound.ts",
    "depends_on": [],
    "source_code": "async function handleBilling(ctx: any, userId: any): Promise<void> {\n  await ctx.scheduler.runAfter(0, internal.twilioMutations.handleBillingPortalAction, {\n    userId,\n  });\n}",
    "start_line": 251,
    "end_line": 255,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "userId"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function handleBilling",
    "component_id": "convex.inbound.handleBilling"
  },
  "convex.inbound.handleUpdatePayment": {
    "id": "convex.inbound.handleUpdatePayment",
    "name": "handleUpdatePayment",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/inbound.ts",
    "relative_path": "convex/inbound.ts",
    "depends_on": [],
    "source_code": "async function handleUpdatePayment(ctx: any, userId: any): Promise<void> {\n  await ctx.scheduler.runAfter(0, internal.twilioMutations.handleBillingPortalAction, {\n    userId,\n  });\n}",
    "start_line": 260,
    "end_line": 264,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "userId"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function handleUpdatePayment",
    "component_id": "convex.inbound.handleUpdatePayment"
  },
  "convex.internal.agentRuns.AgentRun": {
    "id": "convex.internal.agentRuns.AgentRun",
    "name": "AgentRun",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/agentRuns.ts",
    "relative_path": "convex/internal/agentRuns.ts",
    "depends_on": [
      "convex._generated.dataModel.d.Id"
    ],
    "source_code": "interface AgentRun {\n  _id: Id<\"agent_runs\">;\n  _creationTime: number;\n  userId: Id<\"users\">;\n  // Preferred fields\n  agentName?: \"main\" | \"assessment\";\n  threadId?: string;\n  toolCalls?: Array<any>;\n  createdAt?: number;\n  // Legacy fields\n  agent?: string;\n  budgetResult?: any;\n  latencyMs?: number;\n  policyBundle?: string;\n  traceId?: string;\n}",
    "start_line": 73,
    "end_line": 88,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface AgentRun",
    "component_id": "convex.internal.agentRuns.AgentRun"
  },
  "convex.internal.agentRuns.normalizeAgentRun": {
    "id": "convex.internal.agentRuns.normalizeAgentRun",
    "name": "normalizeAgentRun",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/agentRuns.ts",
    "relative_path": "convex/internal/agentRuns.ts",
    "depends_on": [
      "convex.internal.agentRuns.AgentRun"
    ],
    "source_code": "function normalizeAgentRun(run: AgentRun): {\n  agentName: \"main\" | \"assessment\";\n  threadId?: string;\n  toolCalls?: Array<any>;\n  createdAt: number;\n} {\n  // Use agentName if available, otherwise convert agent to agentName\n  const agentName: \"main\" | \"assessment\" =\n    run.agentName ||\n    (run.agent === \"main\" || run.agent === \"assessment\"\n      ? (run.agent)\n      : \"main\"); // Default to \"main\" if unknown\n\n  // Extract toolCalls from budgetResult if available\n  const toolCalls =\n    run.toolCalls ||\n    (run.budgetResult?.toolCalls\n      ? [{ count: run.budgetResult.toolCalls }]\n      : undefined);\n\n  // Use createdAt if available, otherwise use _creationTime\n  const createdAt = run.createdAt || run._creationTime;\n\n  return {\n    agentName,\n    threadId: run.threadId,\n    toolCalls,\n    createdAt,\n  };\n}",
    "start_line": 94,
    "end_line": 123,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "run"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function normalizeAgentRun",
    "component_id": "convex.internal.agentRuns.normalizeAgentRun"
  },
  "convex.internal.assessments.formatQuestion": {
    "id": "convex.internal.assessments.formatQuestion",
    "name": "formatQuestion",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/assessments.ts",
    "relative_path": "convex/internal/assessments.ts",
    "depends_on": [],
    "source_code": "function formatQuestion(questionText: string, index: number, total: number): string {\n  const progress = `(${index + 1} of ${total})`;\n  const skipHint = index === 0 ? \" Reply 1-5 or skip.\" : \" Reply 1-5 or skip.\";\n  return `${progress} ${questionText}${skipHint}`;\n}",
    "start_line": 15,
    "end_line": 19,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "questionText",
      "index",
      "total"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function formatQuestion",
    "component_id": "convex.internal.assessments.formatQuestion"
  },
  "convex.internal.memories.getRelevantMemories": {
    "id": "convex.internal.memories.getRelevantMemories",
    "name": "getRelevantMemories",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/memories.ts",
    "relative_path": "convex/internal/memories.ts",
    "depends_on": [
      "convex._generated.server.d.QueryCtx",
      "convex._generated.dataModel.d.Id"
    ],
    "source_code": "async function getRelevantMemories(\n  ctx: QueryCtx,\n  userId: Id<\"users\">,\n  limit: number = 5\n) {\n  // Use range query on importance (>= 7), order by importance desc\n  const memories = await ctx.db\n    .query(\"memories\")\n    .withIndex(\"by_user_and_importance\", (q) =>\n      q.eq(\"userId\", userId).gte(\"importance\", 7)\n    )\n    .order(\"desc\")\n    .take(limit);\n\n  return memories;\n}",
    "start_line": 14,
    "end_line": 29,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "userId",
      "limit"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function getRelevantMemories",
    "component_id": "convex.internal.memories.getRelevantMemories"
  },
  "convex.internal.score.hasRecentCrisis": {
    "id": "convex.internal.score.hasRecentCrisis",
    "name": "hasRecentCrisis",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/score.ts",
    "relative_path": "convex/internal/score.ts",
    "depends_on": [],
    "source_code": "async function hasRecentCrisis(ctx: any, userId: any, days: number): Promise<boolean> {\n  const threshold = Date.now() - days * 24 * 60 * 60 * 1000;\n  // Limit to recent 100 events to prevent unbounded collection\n  // Filter in code since we need to check createdAt >= threshold\n  const recentCrisis = await ctx.db\n    .query(\"guardrail_events\")\n    .withIndex(\"by_user\", (q) => q.eq(\"userId\", userId))\n    .order(\"desc\")\n    .take(100); // Safety limit\n\n  return recentCrisis.some(\n    (event) => event.type === \"crisis\" && event.createdAt >= threshold\n  );\n}",
    "start_line": 236,
    "end_line": 249,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "userId",
      "days"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function hasRecentCrisis",
    "component_id": "convex.internal.score.hasRecentCrisis"
  },
  "convex.internal.sms.withUserPhone": {
    "id": "convex.internal.sms.withUserPhone",
    "name": "withUserPhone",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/sms.ts",
    "relative_path": "convex/internal/sms.ts",
    "depends_on": [],
    "source_code": "async function withUserPhone(\n  ctx: any,\n  userId: any,\n  fn: (user: any, phone: string) => Promise<void> | void\n): Promise<void> {\n  const user = await ctx.runQuery(internal.internal.users.getUser, { userId });\n  if (!user?.phone) {\n    await ctx.runMutation(internal.internal.sms.logSmsIssue, {\n      userId,\n      reason: \"missing_phone\",\n      context: \"Attempted SMS send without phone\",\n    });\n    return;\n  }\n  await fn(user, user.phone);\n}",
    "start_line": 15,
    "end_line": 30,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "userId",
      "fn"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function withUserPhone",
    "component_id": "convex.internal.sms.withUserPhone"
  },
  "convex.internal.sms.hasRecentInbound": {
    "id": "convex.internal.sms.hasRecentInbound",
    "name": "hasRecentInbound",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/sms.ts",
    "relative_path": "convex/internal/sms.ts",
    "depends_on": [],
    "source_code": "async function hasRecentInbound(\n  ctx: any,\n  userId: any,\n  hours: number\n): Promise<boolean> {\n  const threshold = Date.now() - hours * 60 * 60 * 1000;\n  const recentReceipt = await ctx.runQuery(\n    internal.internal.users.getRecentInboundReceipt,\n    {\n      userId,\n      since: threshold,\n    }\n  );\n  return recentReceipt !== null;\n}",
    "start_line": 243,
    "end_line": 257,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "userId",
      "hours"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function hasRecentInbound",
    "component_id": "convex.internal.sms.hasRecentInbound"
  },
  "convex.internal.sms.isQuietHours": {
    "id": "convex.internal.sms.isQuietHours",
    "name": "isQuietHours",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/sms.ts",
    "relative_path": "convex/internal/sms.ts",
    "depends_on": [],
    "source_code": "function isQuietHours(userTimezone?: string): boolean {\n  const now = new Date();\n  // Simplified: use UTC hours if timezone not available\n  // In production, use proper timezone library\n  const hour = now.getUTCHours();\n  \n  // Quiet hours: 9:00-19:00 (9 AM - 7 PM)\n  // Never send after 20:00 (8 PM)\n  return hour >= 9 && hour < 20; // 9 AM to 7:59 PM\n}",
    "start_line": 263,
    "end_line": 272,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "userTimezone"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function isQuietHours",
    "component_id": "convex.internal.sms.isQuietHours"
  },
  "convex.internal.stripe.StripeSubscriptionStatus": {
    "id": "convex.internal.stripe.StripeSubscriptionStatus",
    "name": "StripeSubscriptionStatus",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/stripe.ts",
    "relative_path": "convex/internal/stripe.ts",
    "depends_on": [],
    "source_code": "type StripeSubscriptionStatus = \"active\" | \"canceled\" | \"past_due\";",
    "start_line": 11,
    "end_line": 11,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type StripeSubscriptionStatus",
    "component_id": "convex.internal.stripe.StripeSubscriptionStatus"
  },
  "convex.internal.stripe.SubscriptionPlan": {
    "id": "convex.internal.stripe.SubscriptionPlan",
    "name": "SubscriptionPlan",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/stripe.ts",
    "relative_path": "convex/internal/stripe.ts",
    "depends_on": [],
    "source_code": "type SubscriptionPlan = \"monthly\" | \"annual\";",
    "start_line": 12,
    "end_line": 12,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type SubscriptionPlan",
    "component_id": "convex.internal.stripe.SubscriptionPlan"
  },
  "convex.internal.stripe.SubscriptionState": {
    "id": "convex.internal.stripe.SubscriptionState",
    "name": "SubscriptionState",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/stripe.ts",
    "relative_path": "convex/internal/stripe.ts",
    "depends_on": [
      "convex.internal.stripe.SubscriptionPlan",
      "convex.internal.stripe.StripeSubscriptionStatus"
    ],
    "source_code": "interface SubscriptionState {\n  userId?: string;\n  stripeCustomerId: string;\n  planId: SubscriptionPlan;\n  status: StripeSubscriptionStatus;\n  currentPeriodEnd: number;\n  canceledAt?: number;\n  gracePeriodEndsAt?: number;\n}",
    "start_line": 14,
    "end_line": 22,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface SubscriptionState",
    "component_id": "convex.internal.stripe.SubscriptionState"
  },
  "convex.internal.stripe.mapStripeEventToSubscription": {
    "id": "convex.internal.stripe.mapStripeEventToSubscription",
    "name": "mapStripeEventToSubscription",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/stripe.ts",
    "relative_path": "convex/internal/stripe.ts",
    "depends_on": [
      "convex.internal.stripe.SubscriptionState",
      "convex.internal.stripe.StripeSubscriptionStatus"
    ],
    "source_code": "function mapStripeEventToSubscription(event: { id: string; type: string; data: { object: any } }): SubscriptionState | null {\n  const { type, data } = event;\n  const obj = data.object;\n\n  switch (type) {\n    case \"checkout.session.completed\":\n      return null;\n\n    case \"customer.subscription.created\":\n    case \"customer.subscription.updated\": {\n      const customerId = obj.customer as string;\n      const status = obj.status as string;\n      const currentPeriodEnd = (obj.current_period_end as number) * 1000;\n      const canceledAt = obj.canceled_at ? (obj.canceled_at as number) * 1000 : undefined;\n\n      let subscriptionStatus: StripeSubscriptionStatus = \"active\";\n      if (status === \"canceled\" || status === \"unpaid\") {\n        subscriptionStatus = \"canceled\";\n      } else if (status === \"past_due\") {\n        subscriptionStatus = \"past_due\";\n      }\n\n      const gracePeriodEndsAt = canceledAt && subscriptionStatus === \"canceled\"\n        ? canceledAt + 30 * 24 * 60 * 60 * 1000\n        : undefined;\n\n      const planId = obj.metadata?.planId || obj.metadata?.plan_id || \"monthly\";\n\n      return {\n        stripeCustomerId: customerId,\n        planId: (planId === \"monthly\" || planId === \"annual\") ? planId : \"monthly\",\n        status: subscriptionStatus,\n        currentPeriodEnd,\n        canceledAt,\n        gracePeriodEndsAt,\n      };\n    }\n\n    case \"customer.subscription.deleted\": {\n      const customerId = obj.customer as string;\n      const canceledAt = Date.now();\n      const gracePeriodEndsAt = canceledAt + 30 * 24 * 60 * 60 * 1000;\n      const planId = obj.metadata?.planId || obj.metadata?.plan_id || \"monthly\";\n\n      return {\n        stripeCustomerId: customerId,\n        planId: (planId === \"monthly\" || planId === \"annual\") ? planId : \"monthly\",\n        status: \"canceled\",\n        currentPeriodEnd: (obj.current_period_end as number) * 1000,\n        canceledAt,\n        gracePeriodEndsAt,\n      };\n    }\n\n    default:\n      return null;\n  }\n}",
    "start_line": 24,
    "end_line": 81,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "event"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function mapStripeEventToSubscription",
    "component_id": "convex.internal.stripe.mapStripeEventToSubscription"
  },
  "convex.internal.subscriptions.SubscriptionAccessScenario": {
    "id": "convex.internal.subscriptions.SubscriptionAccessScenario",
    "name": "SubscriptionAccessScenario",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/subscriptions.ts",
    "relative_path": "convex/internal/subscriptions.ts",
    "depends_on": [],
    "source_code": "type SubscriptionAccessScenario = {\n  hasAccess: boolean;\n  scenario:\n    | \"new_user\"\n    | \"active\"\n    | \"grace_period\"\n    | \"grace_expired\"\n    | \"past_due\"\n    | \"incomplete\"\n    | \"unknown\";\n  gracePeriodEndsAt?: number;\n};",
    "start_line": 8,
    "end_line": 19,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type SubscriptionAccessScenario",
    "component_id": "convex.internal.subscriptions.SubscriptionAccessScenario"
  },
  "convex.internal.subscriptions.computeAccessScenario": {
    "id": "convex.internal.subscriptions.computeAccessScenario",
    "name": "computeAccessScenario",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/internal/subscriptions.ts",
    "relative_path": "convex/internal/subscriptions.ts",
    "depends_on": [
      "convex.internal.subscriptions.SubscriptionAccessScenario"
    ],
    "source_code": "function computeAccessScenario(subscription: any | null): SubscriptionAccessScenario {\n  if (!subscription) {\n    return { hasAccess: false, scenario: \"new_user\" };\n  }\n\n  const now = Date.now();\n\n  if (subscription.status === \"active\") {\n    return { hasAccess: true, scenario: \"active\" };\n  }\n\n  if (subscription.status === \"canceled\" && subscription.gracePeriodEndsAt) {\n    if (now < subscription.gracePeriodEndsAt) {\n      return {\n        hasAccess: true,\n        scenario: \"grace_period\",\n        gracePeriodEndsAt: subscription.gracePeriodEndsAt,\n      };\n    }\n    return { hasAccess: false, scenario: \"grace_expired\" };\n  }\n\n  if (subscription.status === \"past_due\") {\n    return { hasAccess: false, scenario: \"past_due\" };\n  }\n\n  // Future-proof: allow for additional statuses like \"incomplete\"\n  return { hasAccess: false, scenario: \"unknown\" };\n}",
    "start_line": 25,
    "end_line": 53,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "subscription"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function computeAccessScenario",
    "component_id": "convex.internal.subscriptions.computeAccessScenario"
  },
  "convex.interventions.evidenceRank": {
    "id": "convex.interventions.evidenceRank",
    "name": "evidenceRank",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/interventions.ts",
    "relative_path": "convex/interventions.ts",
    "depends_on": [],
    "source_code": "function evidenceRank(level: string): number {\n  if (level === \"high\") return 0;\n  if (level === \"moderate\") return 1;\n  return 2;\n}",
    "start_line": 11,
    "end_line": 15,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "level"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function evidenceRank",
    "component_id": "convex.interventions.evidenceRank"
  },
  "convex.interventions.durationMinutes": {
    "id": "convex.interventions.durationMinutes",
    "name": "durationMinutes",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/interventions.ts",
    "relative_path": "convex/interventions.ts",
    "depends_on": [],
    "source_code": "function durationMinutes(duration: string): number {\n  const match = /(\\d+)(?:-(\\d+))?\\s*min/.exec(duration || \"\");\n  if (!match) return 999;\n  if (match[2]) {\n    return (Number(match[1]) + Number(match[2])) / 2;\n  }\n  return Number(match[1]);\n}",
    "start_line": 20,
    "end_line": 27,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "duration"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function durationMinutes",
    "component_id": "convex.interventions.durationMinutes"
  },
  "convex.lib.assessmentCatalog.AssessmentType": {
    "id": "convex.lib.assessmentCatalog.AssessmentType",
    "name": "AssessmentType",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/assessmentCatalog.ts",
    "relative_path": "convex/lib/assessmentCatalog.ts",
    "depends_on": [],
    "source_code": "type AssessmentType = \"ema\" | \"sdoh\";",
    "start_line": 6,
    "end_line": 6,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type AssessmentType",
    "component_id": "convex.lib.assessmentCatalog.AssessmentType"
  },
  "convex.lib.assessmentCatalog.AssessmentQuestion": {
    "id": "convex.lib.assessmentCatalog.AssessmentQuestion",
    "name": "AssessmentQuestion",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/assessmentCatalog.ts",
    "relative_path": "convex/lib/assessmentCatalog.ts",
    "depends_on": [],
    "source_code": "interface AssessmentQuestion {\n  id: string;\n  text: string;\n  zone?: string; // For zone-based scoring\n}",
    "start_line": 8,
    "end_line": 12,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface AssessmentQuestion",
    "component_id": "convex.lib.assessmentCatalog.AssessmentQuestion"
  },
  "convex.lib.assessmentCatalog.AssessmentDefinition": {
    "id": "convex.lib.assessmentCatalog.AssessmentDefinition",
    "name": "AssessmentDefinition",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/assessmentCatalog.ts",
    "relative_path": "convex/lib/assessmentCatalog.ts",
    "depends_on": [
      "convex.lib.assessmentCatalog.AssessmentType",
      "convex.lib.assessmentCatalog.AssessmentQuestion"
    ],
    "source_code": "interface AssessmentDefinition {\n  id: AssessmentType;\n  title: string;\n  description: string;\n  questions: AssessmentQuestion[];\n  cooldownDays: number;\n  zones: string[]; // Pressure zones this assessment covers\n}",
    "start_line": 14,
    "end_line": 21,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface AssessmentDefinition",
    "component_id": "convex.lib.assessmentCatalog.AssessmentDefinition"
  },
  "convex.lib.assessmentCatalog.getAssessmentDefinition": {
    "id": "convex.lib.assessmentCatalog.getAssessmentDefinition",
    "name": "getAssessmentDefinition",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/assessmentCatalog.ts",
    "relative_path": "convex/lib/assessmentCatalog.ts",
    "depends_on": [
      "convex.lib.assessmentCatalog.AssessmentType",
      "convex.lib.assessmentCatalog.AssessmentDefinition"
    ],
    "source_code": "function getAssessmentDefinition(\n  type: AssessmentType\n): AssessmentDefinition {\n  switch (type) {\n    case \"ema\":\n      return EMA_DEFINITION;\n    case \"sdoh\":\n      return SDOH_DEFINITION;\n    default: {\n      // TypeScript knows all cases are handled, but we need this for runtime safety\n      const _exhaustive: never = type;\n      throw new Error(`Unknown assessment type: ${String(_exhaustive)}`);\n    }\n  }\n}",
    "start_line": 215,
    "end_line": 229,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "type"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getAssessmentDefinition",
    "component_id": "convex.lib.assessmentCatalog.getAssessmentDefinition"
  },
  "convex.lib.assessmentCatalog.getAllAssessmentDefinitions": {
    "id": "convex.lib.assessmentCatalog.getAllAssessmentDefinitions",
    "name": "getAllAssessmentDefinitions",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/assessmentCatalog.ts",
    "relative_path": "convex/lib/assessmentCatalog.ts",
    "depends_on": [
      "convex.lib.assessmentCatalog.AssessmentDefinition"
    ],
    "source_code": "function getAllAssessmentDefinitions(): AssessmentDefinition[] {\n  return [\n    EMA_DEFINITION,\n    SDOH_DEFINITION,\n  ];\n}",
    "start_line": 234,
    "end_line": 239,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getAllAssessmentDefinitions",
    "component_id": "convex.lib.assessmentCatalog.getAllAssessmentDefinitions"
  },
  "convex.lib.assessmentScoring.AssessmentAnswer": {
    "id": "convex.lib.assessmentScoring.AssessmentAnswer",
    "name": "AssessmentAnswer",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/assessmentScoring.ts",
    "relative_path": "convex/lib/assessmentScoring.ts",
    "depends_on": [],
    "source_code": "interface AssessmentAnswer {\n  questionId: string;\n  value: number;\n}",
    "start_line": 10,
    "end_line": 13,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface AssessmentAnswer",
    "component_id": "convex.lib.assessmentScoring.AssessmentAnswer"
  },
  "convex.lib.assessmentScoring.ScoringResult": {
    "id": "convex.lib.assessmentScoring.ScoringResult",
    "name": "ScoringResult",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/assessmentScoring.ts",
    "relative_path": "convex/lib/assessmentScoring.ts",
    "depends_on": [],
    "source_code": "interface ScoringResult {\n  gcBurnout: number;\n  band: string;\n  rawComposite: number;\n  zones: {\n    P1?: number;\n    P2?: number;\n    P3?: number;\n    P4?: number;\n    P5?: number;\n    P6?: number;\n  };\n  answeredRatio: number;\n}",
    "start_line": 15,
    "end_line": 28,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface ScoringResult",
    "component_id": "convex.lib.assessmentScoring.ScoringResult"
  },
  "convex.lib.assessmentScoring.calculateAssessmentScores": {
    "id": "convex.lib.assessmentScoring.calculateAssessmentScores",
    "name": "calculateAssessmentScores",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/assessmentScoring.ts",
    "relative_path": "convex/lib/assessmentScoring.ts",
    "depends_on": [
      "convex.lib.scoreCalculator.calculateZoneAverage",
      "convex.lib.sdoh.getBandFromRiskLevel",
      "convex.lib.assessmentCatalog.AssessmentDefinition",
      "convex.lib.assessmentScoring.ScoringResult",
      "convex.lib.assessmentScoring.AssessmentAnswer",
      "convex.lib.sdoh.getRiskLevel"
    ],
    "source_code": "function calculateAssessmentScores(\n  answers: AssessmentAnswer[],\n  definition: AssessmentDefinition\n): ScoringResult {\n  // Filter out any non-numeric answers (safety check)\n  const answeredValues = answers.filter((a) => typeof a.value === \"number\");\n  const answeredRatio = answeredValues.length / definition.questions.length;\n\n  if (answeredValues.length === 0) {\n    throw new Error(\"No answers provided\");\n  }\n\n  // Calculate raw scores by zone (dynamically based on question.zone)\n  const zoneScores: Record<string, number[]> = {};\n  for (const answer of answeredValues) {\n    const question = definition.questions.find((q) => q.id === answer.questionId);\n    if (question?.zone) {\n      if (!zoneScores[question.zone]) {\n        zoneScores[question.zone] = [];\n      }\n      zoneScores[question.zone].push(answer.value);\n    }\n  }\n\n  // Calculate zone averages (only for zones with answers)\n  const zones: ScoringResult[\"zones\"] = {};\n  for (const [zone, values] of Object.entries(zoneScores)) {\n    if (values.length > 0) {\n      zones[zone as keyof ScoringResult[\"zones\"]] = calculateZoneAverage(values);\n    }\n  }\n\n  // Calculate composite score (average of answered questions, normalized to 0-100)\n  const allValues = answeredValues.map((a) => a.value);\n  const avgScore = allValues.reduce((sum, v) => sum + v, 0) / allValues.length; // Raw average (1-5 scale)\n  const composite = avgScore * 20; // Normalize to 0-100\n  const gcBurnout = Math.round(composite);\n\n  // Determine band using getRiskLevel (single source of truth)\n  const riskLevel = getRiskLevel(gcBurnout);\n  const band = getBandFromRiskLevel(riskLevel);\n\n  return {\n    gcBurnout,\n    band,\n    rawComposite: avgScore,\n    zones,\n    answeredRatio,\n  };\n}",
    "start_line": 34,
    "end_line": 83,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "answers",
      "definition"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function calculateAssessmentScores",
    "component_id": "convex.lib.assessmentScoring.calculateAssessmentScores"
  },
  "convex.lib.intentInterpreter.IntentAnalysis": {
    "id": "convex.lib.intentInterpreter.IntentAnalysis",
    "name": "IntentAnalysis",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/intentInterpreter.ts",
    "relative_path": "convex/lib/intentInterpreter.ts",
    "depends_on": [],
    "source_code": "interface IntentAnalysis {\n  intent: \"caregiving\" | \"personal\" | \"general\" | \"emergency\";\n  sdohZones: string[]; // P1-P6 zones this query relates to\n  searchTiers: string[]; // Ordered search refinements (specific  general)\n  isGeographical: boolean;\n  reasoning: string;\n}",
    "start_line": 10,
    "end_line": 16,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface IntentAnalysis",
    "component_id": "convex.lib.intentInterpreter.IntentAnalysis"
  },
  "convex.lib.intentInterpreter.interpretSearchIntent": {
    "id": "convex.lib.intentInterpreter.interpretSearchIntent",
    "name": "interpretSearchIntent",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/intentInterpreter.ts",
    "relative_path": "convex/lib/intentInterpreter.ts",
    "depends_on": [
      "convex.lib.intentInterpreter.IntentAnalysis",
      "convex.lib.intentInterpreter.fallbackIntentAnalysis"
    ],
    "source_code": "async function interpretSearchIntent(\n  query: string,\n  userContext: {\n    zones?: Record<string, number>;\n    gcSdohScore?: number;\n    metadata?: any;\n  }\n): Promise<IntentAnalysis> {\n  const apiKey = process.env.GOOGLE_GENERATIVE_AI_API_KEY || process.env.GEMINI_API_KEY;\n  if (!apiKey) {\n    // Fallback to simple classification if no API key\n    return fallbackIntentAnalysis(query);\n  }\n\n  const ai = new GoogleGenAI({ apiKey });\n\n  const prompt = `Analyze this user query for a caregiver support application.\n\nUser Query: \"${query}\"\n\nUser Context:\n${userContext.zones ? `- Current SDOH Zone Scores: ${JSON.stringify(userContext.zones)}` : \"\"}\n${userContext.gcSdohScore ? `- Overall Burnout Score: ${userContext.gcSdohScore}/100` : \"\"}\n\nSDOH Zone Framework:\n${Object.entries(SDOH_ZONES).map(([zone, desc]) => `${zone}: ${desc}`).join('\\n')}\n\nYour Task:\n1. Classify the intent:\n   - \"caregiving\": Directly related to caregiving duties (respite, support groups, etc.)\n   - \"personal\": Personal wellbeing outside caregiving (hobbies, self-care, travel)\n   - \"general\": General life needs (food, transport, housing)\n   - \"emergency\": Crisis or urgent need\n\n2. Map to relevant SDOH zones (P1-P6) based on what the query addresses\n\n3. Determine if query has geographical context (looking for physical locations)\n\n4. Generate 3 tiered search refinements:\n   - Tier 1: Most specific interpretation of the query\n   - Tier 2: Broader category with same intent\n   - Tier 3: General category as fallback\n\nReturn ONLY valid JSON (no markdown):\n{\n  \"intent\": \"personal\",\n  \"sdohZones\": [\"P1\", \"P6\"],\n  \"searchTiers\": [\n    \"quiet coworking spaces for focused work\",\n    \"low-stimulation environments for introverts\",\n    \"mental wellness spaces\"\n  ],\n  \"isGeographical\": true,\n  \"reasoning\": \"Query seeks personal wellbeing resources for managing social energy (P1) and mental health (P6) during travel\"\n}`;\n\n  try {\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash-lite\",\n      contents: prompt,\n      config: {\n        responseMimeType: \"application/json\",\n        maxOutputTokens: 500,\n      },\n    });\n\n    const candidate = response.candidates?.[0];\n    if (!candidate) {\n      return fallbackIntentAnalysis(query);\n    }\n\n    const text = candidate.content?.parts?.[0]?.text;\n    if (!text) {\n      return fallbackIntentAnalysis(query);\n    }\n\n    const result = JSON.parse(text);\n\n    // Validate and return\n    if (!result.intent || !result.sdohZones || !result.searchTiers) {\n      console.warn(\"Invalid intent analysis, using fallback\");\n      return fallbackIntentAnalysis(query);\n    }\n\n    return result;\n  } catch (error) {\n    console.error(\"Intent interpretation failed:\", error);\n    return fallbackIntentAnalysis(query);\n  }\n}",
    "start_line": 34,
    "end_line": 123,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "query",
      "userContext"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function interpretSearchIntent",
    "component_id": "convex.lib.intentInterpreter.interpretSearchIntent"
  },
  "convex.lib.intentInterpreter.fallbackIntentAnalysis": {
    "id": "convex.lib.intentInterpreter.fallbackIntentAnalysis",
    "name": "fallbackIntentAnalysis",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/intentInterpreter.ts",
    "relative_path": "convex/lib/intentInterpreter.ts",
    "depends_on": [
      "convex.lib.intentInterpreter.IntentAnalysis"
    ],
    "source_code": "function fallbackIntentAnalysis(query: string): IntentAnalysis {\n  const lowerQuery = query.toLowerCase();\n\n  // Simple keyword detection\n  const isCaregiving = /respite|caregiver|support group|elder|senior|care|hospice|memory/.test(lowerQuery);\n  const isEmergency = /crisis|emergency|urgent|911|help now/.test(lowerQuery);\n  const isGeographical = /near|nearby|in |around|local|city|town|zip/.test(lowerQuery);\n\n  // Simple zone mapping\n  const zones: string[] = [];\n  if (/lonely|isolated|social|friend|group/.test(lowerQuery)) zones.push(\"P1\");\n  if (/tired|pain|health|sleep|physical/.test(lowerQuery)) zones.push(\"P2\");\n  if (/home|house|safety|modify/.test(lowerQuery)) zones.push(\"P3\");\n  if (/money|financial|afford|cost|benefit/.test(lowerQuery)) zones.push(\"P4\");\n  if (/time|schedule|busy|overwhelm/.test(lowerQuery)) zones.push(\"P5\");\n  if (/stress|anxiety|mental|burnout|depress/.test(lowerQuery)) zones.push(\"P6\");\n\n  return {\n    intent: isEmergency ? \"emergency\" : isCaregiving ? \"caregiving\" : \"general\",\n    sdohZones: zones.length > 0 ? zones : [\"P1\"], // Default to P1\n    searchTiers: [\n      query, // Use query as-is\n      query.split(\" \").slice(0, 3).join(\" \"), // First 3 words\n      \"general resources\", // Generic fallback\n    ],\n    isGeographical,\n    reasoning: \"Fallback analysis (Gemini unavailable)\",\n  };\n}",
    "start_line": 129,
    "end_line": 157,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "query"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function fallbackIntentAnalysis",
    "component_id": "convex.lib.intentInterpreter.fallbackIntentAnalysis"
  },
  "convex.lib.intentInterpreter.getZoneDisplayName": {
    "id": "convex.lib.intentInterpreter.getZoneDisplayName",
    "name": "getZoneDisplayName",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/intentInterpreter.ts",
    "relative_path": "convex/lib/intentInterpreter.ts",
    "depends_on": [],
    "source_code": "function getZoneDisplayName(zone: string): string {\n  const names: Record<string, string> = {\n    P1: \"Social Support\",\n    P2: \"Physical Health\",\n    P3: \"Housing & Environment\",\n    P4: \"Financial Resources\",\n    P5: \"Time & Care Coordination\",\n    P6: \"Mental Health\",\n  };\n  return names[zone] || zone;\n}",
    "start_line": 162,
    "end_line": 172,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "zone"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getZoneDisplayName",
    "component_id": "convex.lib.intentInterpreter.getZoneDisplayName"
  },
  "convex.lib.maps.LocationData": {
    "id": "convex.lib.maps.LocationData",
    "name": "LocationData",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/maps.ts",
    "relative_path": "convex/lib/maps.ts",
    "depends_on": [],
    "source_code": "interface LocationData {\n  zipCode: string;\n  latitude?: number;\n  longitude?: number;\n}",
    "start_line": 12,
    "end_line": 16,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface LocationData",
    "component_id": "convex.lib.maps.LocationData"
  },
  "convex.lib.maps.MapsGroundingResult": {
    "id": "convex.lib.maps.MapsGroundingResult",
    "name": "MapsGroundingResult",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/maps.ts",
    "relative_path": "convex/lib/maps.ts",
    "depends_on": [],
    "source_code": "interface MapsGroundingResult {\n  resources: Array<{\n    placeId: string;\n    name: string;\n    address?: string;\n    uri?: string;\n    types?: string[];\n  }>;\n  widgetToken?: string;\n  text: string; // Formatted response\n  searchQuery: string; // The actual query used\n}",
    "start_line": 18,
    "end_line": 29,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface MapsGroundingResult",
    "component_id": "convex.lib.maps.MapsGroundingResult"
  },
  "convex.lib.maps.searchWithMapsGrounding": {
    "id": "convex.lib.maps.searchWithMapsGrounding",
    "name": "searchWithMapsGrounding",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/maps.ts",
    "relative_path": "convex/lib/maps.ts",
    "depends_on": [
      "convex.lib.maps.MapsGroundingResult",
      "convex.lib.maps.LocationData",
      "convex.lib.maps.formatPlacesForSMS"
    ],
    "source_code": "async function searchWithMapsGrounding(\n  query: string,\n  location: LocationData,\n  timeoutMs: number = MAPS_FETCH_TIMEOUT_MS\n): Promise<MapsGroundingResult> {\n  const apiKey = process.env.GOOGLE_GENERATIVE_AI_API_KEY || process.env.GEMINI_API_KEY;\n  if (!apiKey) {\n    throw new Error(\"GOOGLE_GENERATIVE_AI_API_KEY not configured\");\n  }\n\n  const ai = new GoogleGenAI({ apiKey });\n\n  // Build natural query with location context\n  const searchQuery = `${query} near ${location.zipCode}`;\n\n  // Config per official docs\n  const config: any = {\n    tools: [{ googleMaps: { enableWidget: true } }],\n    maxOutputTokens: 500,\n  };\n\n  // Add lat/lng context if available (improves accuracy)\n  if (location.latitude && location.longitude) {\n    config.toolConfig = {\n      retrievalConfig: {\n        latLng: {\n          latitude: location.latitude,\n          longitude: location.longitude,\n        },\n      },\n    };\n  }\n\n  // Timeout protection\n  const timeoutPromise = new Promise<never>((_, reject) => {\n    setTimeout(() => reject(new Error(\"Maps Grounding timeout\")), timeoutMs);\n  });\n\n  const apiPromise = ai.models.generateContent({\n    model: \"gemini-2.5-flash-lite\",\n    contents: searchQuery,\n    config,\n  });\n\n  const response = await Promise.race([apiPromise, timeoutPromise]);\n\n  // Extract grounding metadata\n  const candidate = response.candidates?.[0];\n  if (!candidate) {\n    throw new Error(\"No response candidate from Maps Grounding\");\n  }\n\n  const groundingMetadata = candidate.groundingMetadata as any;\n  if (!groundingMetadata?.groundingChunks) {\n    throw new Error(\"No Maps Grounding results found\");\n  }\n\n  // Extract place data (policy-compliant: placeId, name, address, types)\n  const resources = groundingMetadata.groundingChunks\n    .filter((chunk: any) => chunk.maps)\n    .map((chunk: any) => {\n      const maps = chunk.maps;\n      return {\n        placeId: maps.placeId || maps.id || '',\n        name: maps.title || maps.name || 'Unknown',\n        address: maps.formattedAddress || maps.address,\n        uri: maps.uri,\n        types: maps.types || [],\n      };\n    })\n    .filter((r: any) => r.placeId); // Only include valid places\n\n  const widgetToken = groundingMetadata.googleMapsWidgetContextToken;\n\n  // Get response text\n  const text = candidate.content?.parts?.[0]?.text ||\n    formatPlacesForSMS(resources);\n\n  return {\n    resources,\n    widgetToken,\n    text,\n    searchQuery,\n  };\n}",
    "start_line": 37,
    "end_line": 121,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "query",
      "location",
      "timeoutMs"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function searchWithMapsGrounding",
    "component_id": "convex.lib.maps.searchWithMapsGrounding"
  },
  "convex.lib.maps.formatPlacesForSMS": {
    "id": "convex.lib.maps.formatPlacesForSMS",
    "name": "formatPlacesForSMS",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/maps.ts",
    "relative_path": "convex/lib/maps.ts",
    "depends_on": [],
    "source_code": "function formatPlacesForSMS(\n  places: Array<{ name: string; address?: string; uri?: string }>\n): string {\n  if (places.length === 0) {\n    return \"No locations found.\";\n  }\n\n  const lines = places.slice(0, 3).map((place, i) => {\n    const num = i + 1;\n    const addr = place.address ? `\\n   ${place.address}` : '';\n    const link = place.uri ? `\\n   ${place.uri}` : '';\n    return `${num}. ${place.name}${addr}${link}`;\n  });\n\n  return `Found ${places.length} location${places.length > 1 ? 's' : ''}:\\n${lines.join('\\n\\n')}`;\n}",
    "start_line": 127,
    "end_line": 142,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "places"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function formatPlacesForSMS",
    "component_id": "convex.lib.maps.formatPlacesForSMS"
  },
  "convex.lib.prompts.renderPrompt": {
    "id": "convex.lib.prompts.renderPrompt",
    "name": "renderPrompt",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/prompts.ts",
    "relative_path": "convex/lib/prompts.ts",
    "depends_on": [],
    "source_code": "function renderPrompt(\n  template: string,\n  variables: Record<string, string | number | undefined>\n): string {\n  let result = template;\n  for (const [key, value] of Object.entries(variables)) {\n    if (value !== undefined) {\n      // Escape special regex characters in the key\n      const escapedKey = key.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n      result = result.replace(\n        new RegExp(`{{${escapedKey}}}`, \"g\"),\n        String(value)\n      );\n    }\n  }\n  return result;\n}",
    "start_line": 299,
    "end_line": 315,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "template",
      "variables"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function renderPrompt",
    "component_id": "convex.lib.prompts.renderPrompt"
  },
  "convex.lib.scoreCalculator.ZoneScores": {
    "id": "convex.lib.scoreCalculator.ZoneScores",
    "name": "ZoneScores",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/scoreCalculator.ts",
    "relative_path": "convex/lib/scoreCalculator.ts",
    "depends_on": [],
    "source_code": "interface ZoneScores {\n  P1?: number;\n  P2?: number;\n  P3?: number;\n  P4?: number;\n  P5?: number;\n  P6?: number;\n}",
    "start_line": 8,
    "end_line": 15,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface ZoneScores",
    "component_id": "convex.lib.scoreCalculator.ZoneScores"
  },
  "convex.lib.scoreCalculator.calculateCompositeScore": {
    "id": "convex.lib.scoreCalculator.calculateCompositeScore",
    "name": "calculateCompositeScore",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/scoreCalculator.ts",
    "relative_path": "convex/lib/scoreCalculator.ts",
    "depends_on": [
      "convex.lib.scoreCalculator.ZoneScores",
      "convex.lib.sdoh.getAllZoneIds"
    ],
    "source_code": "function calculateCompositeScore(zones: ZoneScores): number {\n  const zoneIds = getAllZoneIds();\n  const scores: number[] = [];\n\n  for (const zoneId of zoneIds) {\n    const score = zones[zoneId];\n    if (score !== undefined && score !== null) {\n      scores.push(score);\n    }\n  }\n\n  if (scores.length === 0) {\n    return 0;\n  }\n\n  const sum = scores.reduce((acc, val) => acc + val, 0);\n  return Math.round(sum / scores.length);\n}",
    "start_line": 21,
    "end_line": 38,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "zones"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function calculateCompositeScore",
    "component_id": "convex.lib.scoreCalculator.calculateCompositeScore"
  },
  "convex.lib.scoreCalculator.normalizeScore": {
    "id": "convex.lib.scoreCalculator.normalizeScore",
    "name": "normalizeScore",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/scoreCalculator.ts",
    "relative_path": "convex/lib/scoreCalculator.ts",
    "depends_on": [],
    "source_code": "function normalizeScore(score: number): number {\n  return Math.max(0, Math.min(100, Math.round(score)));\n}",
    "start_line": 44,
    "end_line": 46,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "score"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function normalizeScore",
    "component_id": "convex.lib.scoreCalculator.normalizeScore"
  },
  "convex.lib.scoreCalculator.calculateZoneAverage": {
    "id": "convex.lib.scoreCalculator.calculateZoneAverage",
    "name": "calculateZoneAverage",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/scoreCalculator.ts",
    "relative_path": "convex/lib/scoreCalculator.ts",
    "depends_on": [
      "convex.lib.scoreCalculator.normalizeScore"
    ],
    "source_code": "function calculateZoneAverage(answers: number[]): number {\n  if (answers.length === 0) {\n    return 0;\n  }\n\n  // Assume answers are on 1-5 scale, normalize to 0-100\n  // Formula: ((average - 1) / 4) * 100\n  const avg = answers.reduce((sum, val) => sum + val, 0) / answers.length;\n  const normalized = ((avg - 1) / 4) * 100;\n  return normalizeScore(normalized);\n}",
    "start_line": 52,
    "end_line": 62,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "answers"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function calculateZoneAverage",
    "component_id": "convex.lib.scoreCalculator.calculateZoneAverage"
  },
  "convex.lib.scoreCalculator.findWorstZone": {
    "id": "convex.lib.scoreCalculator.findWorstZone",
    "name": "findWorstZone",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/scoreCalculator.ts",
    "relative_path": "convex/lib/scoreCalculator.ts",
    "depends_on": [
      "convex.lib.scoreCalculator.ZoneScores",
      "convex.lib.sdoh.ZoneId",
      "convex.lib.sdoh.getAllZoneIds"
    ],
    "source_code": "function findWorstZone(zones: ZoneScores): ZoneId | null {\n  let worstZone: ZoneId | null = null;\n  let worstScore = -1;\n\n  for (const zoneId of getAllZoneIds()) {\n    const score = zones[zoneId];\n    if (score !== undefined && score !== null && score > worstScore) {\n      worstScore = score;\n      worstZone = zoneId;\n    }\n  }\n\n  return worstZone;\n}",
    "start_line": 67,
    "end_line": 80,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "zones"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function findWorstZone",
    "component_id": "convex.lib.scoreCalculator.findWorstZone"
  },
  "convex.lib.scoreCalculator.getZoneScoresArray": {
    "id": "convex.lib.scoreCalculator.getZoneScoresArray",
    "name": "getZoneScoresArray",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/scoreCalculator.ts",
    "relative_path": "convex/lib/scoreCalculator.ts",
    "depends_on": [
      "convex.lib.scoreCalculator.ZoneScores",
      "convex.lib.sdoh.ZoneId",
      "convex.lib.sdoh.getAllZoneIds"
    ],
    "source_code": "function getZoneScoresArray(zones: ZoneScores): Array<{ zone: ZoneId; score: number }> {\n  return getAllZoneIds()\n    .map((zoneId) => ({\n      zone: zoneId,\n      score: zones[zoneId] ?? 0,\n    }))\n    .filter((item) => item.score > 0);\n}",
    "start_line": 85,
    "end_line": 92,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "zones"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getZoneScoresArray",
    "component_id": "convex.lib.scoreCalculator.getZoneScoresArray"
  },
  "convex.lib.sdoh.ZoneId": {
    "id": "convex.lib.sdoh.ZoneId",
    "name": "ZoneId",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/sdoh.ts",
    "relative_path": "convex/lib/sdoh.ts",
    "depends_on": [],
    "source_code": "type ZoneId = \"P1\" | \"P2\" | \"P3\" | \"P4\" | \"P5\" | \"P6\";",
    "start_line": 6,
    "end_line": 6,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type ZoneId",
    "component_id": "convex.lib.sdoh.ZoneId"
  },
  "convex.lib.sdoh.Zone": {
    "id": "convex.lib.sdoh.Zone",
    "name": "Zone",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/sdoh.ts",
    "relative_path": "convex/lib/sdoh.ts",
    "depends_on": [
      "convex.lib.sdoh.ZoneId"
    ],
    "source_code": "interface Zone {\n  id: ZoneId;\n  name: string;\n  description: string;\n}",
    "start_line": 8,
    "end_line": 12,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface Zone",
    "component_id": "convex.lib.sdoh.Zone"
  },
  "convex.lib.sdoh.getZoneDisplayName": {
    "id": "convex.lib.sdoh.getZoneDisplayName",
    "name": "getZoneDisplayName",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/sdoh.ts",
    "relative_path": "convex/lib/sdoh.ts",
    "depends_on": [
      "convex.lib.sdoh.ZoneId"
    ],
    "source_code": "function getZoneDisplayName(zoneId: ZoneId): string {\n  return ZONES[zoneId].name;\n}",
    "start_line": 53,
    "end_line": 55,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "zoneId"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getZoneDisplayName",
    "component_id": "convex.lib.sdoh.getZoneDisplayName"
  },
  "convex.lib.sdoh.getAllZoneIds": {
    "id": "convex.lib.sdoh.getAllZoneIds",
    "name": "getAllZoneIds",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/sdoh.ts",
    "relative_path": "convex/lib/sdoh.ts",
    "depends_on": [
      "convex.lib.sdoh.ZoneId"
    ],
    "source_code": "function getAllZoneIds(): ZoneId[] {\n  return Object.keys(ZONES) as ZoneId[];\n}",
    "start_line": 60,
    "end_line": 62,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getAllZoneIds",
    "component_id": "convex.lib.sdoh.getAllZoneIds"
  },
  "convex.lib.sdoh.RiskLevel": {
    "id": "convex.lib.sdoh.RiskLevel",
    "name": "RiskLevel",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/sdoh.ts",
    "relative_path": "convex/lib/sdoh.ts",
    "depends_on": [],
    "source_code": "type RiskLevel = \"low\" | \"moderate\" | \"high\" | \"crisis\";",
    "start_line": 67,
    "end_line": 67,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type RiskLevel",
    "component_id": "convex.lib.sdoh.RiskLevel"
  },
  "convex.lib.sdoh.RiskLevelThresholds": {
    "id": "convex.lib.sdoh.RiskLevelThresholds",
    "name": "RiskLevelThresholds",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/sdoh.ts",
    "relative_path": "convex/lib/sdoh.ts",
    "depends_on": [],
    "source_code": "interface RiskLevelThresholds {\n  low: { min: number; max: number };\n  moderate: { min: number; max: number };\n  high: { min: number; max: number };\n  crisis: { min: number; max: number };\n}",
    "start_line": 69,
    "end_line": 74,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface RiskLevelThresholds",
    "component_id": "convex.lib.sdoh.RiskLevelThresholds"
  },
  "convex.lib.sdoh.getRiskLevel": {
    "id": "convex.lib.sdoh.getRiskLevel",
    "name": "getRiskLevel",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/sdoh.ts",
    "relative_path": "convex/lib/sdoh.ts",
    "depends_on": [
      "convex.lib.sdoh.RiskLevel"
    ],
    "source_code": "function getRiskLevel(score: number): RiskLevel {\n  if (score >= 76) return \"crisis\";\n  if (score >= 51) return \"high\";\n  if (score >= 26) return \"moderate\";\n  return \"low\";\n}",
    "start_line": 86,
    "end_line": 91,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "score"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getRiskLevel",
    "component_id": "convex.lib.sdoh.getRiskLevel"
  },
  "convex.lib.sdoh.getRiskLevelDisplay": {
    "id": "convex.lib.sdoh.getRiskLevelDisplay",
    "name": "getRiskLevelDisplay",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/sdoh.ts",
    "relative_path": "convex/lib/sdoh.ts",
    "depends_on": [
      "convex.lib.sdoh.RiskLevel"
    ],
    "source_code": "function getRiskLevelDisplay(riskLevel: RiskLevel): string {\n  const display: Record<RiskLevel, string> = {\n    low: \"low stress\",\n    moderate: \"moderate stress\",\n    high: \"high stress\",\n    crisis: \"crisis level\",\n  };\n  return display[riskLevel];\n}",
    "start_line": 96,
    "end_line": 104,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "riskLevel"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getRiskLevelDisplay",
    "component_id": "convex.lib.sdoh.getRiskLevelDisplay"
  },
  "convex.lib.sdoh.getBandFromRiskLevel": {
    "id": "convex.lib.sdoh.getBandFromRiskLevel",
    "name": "getBandFromRiskLevel",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/sdoh.ts",
    "relative_path": "convex/lib/sdoh.ts",
    "depends_on": [
      "convex.lib.sdoh.RiskLevel"
    ],
    "source_code": "function getBandFromRiskLevel(riskLevel: RiskLevel): \"very_low\" | \"low\" | \"moderate\" | \"high\" {\n  const mapping: Record<RiskLevel, \"very_low\" | \"low\" | \"moderate\" | \"high\"> = {\n    low: \"very_low\", // score 0-25\n    moderate: \"low\", // score 26-50\n    high: \"moderate\", // score 51-75\n    crisis: \"high\", // score 76-100\n  };\n  return mapping[riskLevel];\n}",
    "start_line": 111,
    "end_line": 119,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "riskLevel"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getBandFromRiskLevel",
    "component_id": "convex.lib.sdoh.getBandFromRiskLevel"
  },
  "convex.lib.search.SearchGroundingResult": {
    "id": "convex.lib.search.SearchGroundingResult",
    "name": "SearchGroundingResult",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/search.ts",
    "relative_path": "convex/lib/search.ts",
    "depends_on": [],
    "source_code": "interface SearchGroundingResult {\n  text: string;\n  sources: Array<{\n    title: string;\n    uri: string;\n    snippet?: string;\n  }>;\n  searchQuery: string;\n}",
    "start_line": 12,
    "end_line": 20,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface SearchGroundingResult",
    "component_id": "convex.lib.search.SearchGroundingResult"
  },
  "convex.lib.search.searchWithGemini": {
    "id": "convex.lib.search.searchWithGemini",
    "name": "searchWithGemini",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/search.ts",
    "relative_path": "convex/lib/search.ts",
    "depends_on": [
      "convex.lib.search.SearchGroundingResult"
    ],
    "source_code": "async function searchWithGemini(\n  query: string,\n  useSearchGrounding: boolean = false,\n  timeoutMs: number = SEARCH_TIMEOUT_MS\n): Promise<SearchGroundingResult> {\n  const apiKey = process.env.GOOGLE_GENERATIVE_AI_API_KEY || process.env.GEMINI_API_KEY;\n  if (!apiKey) {\n    throw new Error(\"GOOGLE_GENERATIVE_AI_API_KEY not configured\");\n  }\n\n  const ai = new GoogleGenAI({ apiKey });\n\n  // Build search-oriented prompt\n  const searchQuery = `Find reliable online resources for: ${query}\n\nRequirements:\n- Include specific organizations with their websites\n- Prioritize .org, .gov, and established resources\n- Provide 3-5 high-quality options\n- Include brief descriptions\n- Format as numbered list`;\n\n  const config: any = {\n    maxOutputTokens: 600,\n  };\n\n  // Optional: Enable Google Search Grounding\n  // Note: Search Grounding may not be available in all regions/tiers\n  if (useSearchGrounding) {\n    config.tools = [{ googleSearch: {} }];\n  }\n\n  // Timeout protection\n  const timeoutPromise = new Promise<never>((_, reject) => {\n    setTimeout(() => reject(new Error(\"Search timeout\")), timeoutMs);\n  });\n\n  const apiPromise = ai.models.generateContent({\n    model: \"gemini-2.5-flash-lite\",\n    contents: searchQuery,\n    config,\n  });\n\n  const response = await Promise.race([apiPromise, timeoutPromise]);\n\n  const candidate = response.candidates?.[0];\n  if (!candidate) {\n    throw new Error(\"No response candidate from search\");\n  }\n\n  // Extract text response\n  const text = candidate.content?.parts?.[0]?.text ||\n    \"No resources found. Try being more specific?\";\n\n  // Extract grounding sources if available\n  const sources: Array<{ title: string; uri: string; snippet?: string }> = [];\n\n  if (useSearchGrounding) {\n    const groundingMetadata = candidate.groundingMetadata as any;\n    if (groundingMetadata?.groundingChunks) {\n      groundingMetadata.groundingChunks.forEach((chunk: any) => {\n        if (chunk.web) {\n          sources.push({\n            title: chunk.web.title || 'Untitled',\n            uri: chunk.web.uri,\n            snippet: chunk.web.snippet,\n          });\n        }\n      });\n    }\n  }\n\n  return {\n    text,\n    sources,\n    searchQuery: query,\n  };\n}",
    "start_line": 28,
    "end_line": 105,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "query",
      "useSearchGrounding",
      "timeoutMs"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function searchWithGemini",
    "component_id": "convex.lib.search.searchWithGemini"
  },
  "convex.lib.search.tieredSearch": {
    "id": "convex.lib.search.tieredSearch",
    "name": "tieredSearch",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/search.ts",
    "relative_path": "convex/lib/search.ts",
    "depends_on": [
      "convex.lib.search.searchWithGemini",
      "convex.lib.search.SearchGroundingResult"
    ],
    "source_code": "async function tieredSearch(\n  searchTiers: string[],\n  useSearchGrounding: boolean = false\n): Promise<SearchGroundingResult> {\n  let lastError: Error | null = null;\n\n  for (const tier of searchTiers) {\n    try {\n      const result = await searchWithGemini(tier, useSearchGrounding);\n\n      // Check if we got meaningful results\n      if (result.text && result.text.length > 50) {\n        return result;\n      }\n    } catch (error) {\n      console.log(`Tier search failed: ${tier}`, error);\n      lastError = error as Error;\n      continue; // Try next tier\n    }\n  }\n\n  // All tiers failed\n  throw lastError || new Error(\"All search tiers failed\");\n}",
    "start_line": 111,
    "end_line": 134,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "searchTiers",
      "useSearchGrounding"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function tieredSearch",
    "component_id": "convex.lib.search.tieredSearch"
  },
  "convex.lib.twilio.TwilioStub": {
    "id": "convex.lib.twilio.TwilioStub",
    "name": "TwilioStub",
    "component_type": "class",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/twilio.ts",
    "relative_path": "convex/lib/twilio.ts",
    "depends_on": [
      "convex._generated.server.d.ActionCtx"
    ],
    "source_code": "class TwilioStub {\n  public incomingMessageCallback = internal.inbound.handleIncomingMessage;\n\n  constructor(private defaultFrom: string, private accountSid: string) {}\n\n  registerRoutes(_: unknown) {\n    // No-op in tests  real Twilio client registers HTTP routes\n  }\n\n  async sendMessage(\n    ctx: ActionCtx,\n    args: { to: string; body: string; from?: string }\n  ) {\n    const from = args.from || this.defaultFrom;\n    if (!from) {\n      throw new Error(\n        \"Missing Twilio phone number. Set TWILIO_PHONE_NUMBER or provide a from number.\"\n      );\n    }\n    const now = new Date().toISOString();\n    const sid = `SM${Date.now()}${Math.floor(Math.random() * 1e6)}`;\n    const message = {\n      account_sid: this.accountSid,\n      api_version: \"2010-04-01\",\n      body: args.body,\n      counterparty: args.to,\n      date_created: now,\n      date_sent: now,\n      date_updated: now,\n      direction: \"outbound-api\",\n      error_code: null,\n      error_message: null,\n      from,\n      messaging_service_sid: null,\n      num_media: \"0\",\n      num_segments: \"1\",\n      price: null,\n      price_unit: null,\n      sid,\n      status: \"sent\",\n      subresource_uris: null,\n      to: args.to,\n      uri: `/2010-04-01/Accounts/${this.accountSid}/Messages/${sid}`,\n      rest: { simulated: true },\n    };\n\n    // Note: Component tables are sandboxed and not directly accessible via ctx.db\n    // The real Twilio component handles message insertion automatically\n    // For the stub, we just return the simulated message without inserting it\n    // Tests that query messages should use the real Twilio component or mock appropriately\n    return message;\n  }\n}",
    "start_line": 17,
    "end_line": 69,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "class",
    "base_classes": [],
    "class_name": null,
    "display_name": "class TwilioStub",
    "component_id": "convex.lib.twilio.TwilioStub"
  },
  "convex.lib.twilio.registerRoutes": {
    "id": "convex.lib.twilio.registerRoutes",
    "name": "registerRoutes",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/twilio.ts",
    "relative_path": "convex/lib/twilio.ts",
    "depends_on": [],
    "source_code": "registerRoutes(_: unknown) {\n    // No-op in tests  real Twilio client registers HTTP routes\n  }",
    "start_line": 22,
    "end_line": 24,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "_"
    ],
    "node_type": "method",
    "base_classes": null,
    "class_name": null,
    "display_name": "method registerRoutes",
    "component_id": "convex.lib.twilio.registerRoutes"
  },
  "convex.lib.twilio.sendMessage": {
    "id": "convex.lib.twilio.sendMessage",
    "name": "sendMessage",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/twilio.ts",
    "relative_path": "convex/lib/twilio.ts",
    "depends_on": [],
    "source_code": "async sendMessage(\n    ctx: ActionCtx,\n    args: { to: string; body: string; from?: string }\n  ) {\n    const from = args.from || this.defaultFrom;\n    if (!from) {\n      throw new Error(\n        \"Missing Twilio phone number. Set TWILIO_PHONE_NUMBER or provide a from number.\"\n      );\n    }\n    const now = new Date().toISOString();\n    const sid = `SM${Date.now()}${Math.floor(Math.random() * 1e6)}`;\n    const message = {\n      account_sid: this.accountSid,\n      api_version: \"2010-04-01\",\n      body: args.body,\n      counterparty: args.to,\n      date_created: now,\n      date_sent: now,\n      date_updated: now,\n      direction: \"outbound-api\",\n      error_code: null,\n      error_message: null,\n      from,\n      messaging_service_sid: null,\n      num_media: \"0\",\n      num_segments: \"1\",\n      price: null,\n      price_unit: null,\n      sid,\n      status: \"sent\",\n      subresource_uris: null,\n      to: args.to,\n      uri: `/2010-04-01/Accounts/${this.accountSid}/Messages/${sid}`,\n      rest: { simulated: true },\n    };\n\n    // Note: Component tables are sandboxed and not directly accessible via ctx.db\n    // The real Twilio component handles message insertion automatically\n    // For the stub, we just return the simulated message without inserting it\n    // Tests that query messages should use the real Twilio component or mock appropriately\n    return message;\n  }",
    "start_line": 26,
    "end_line": 68,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "args"
    ],
    "node_type": "method",
    "base_classes": null,
    "class_name": null,
    "display_name": "async method sendMessage",
    "component_id": "convex.lib.twilio.sendMessage"
  },
  "convex.lib.twilio.sendSMS": {
    "id": "convex.lib.twilio.sendSMS",
    "name": "sendSMS",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/twilio.ts",
    "relative_path": "convex/lib/twilio.ts",
    "depends_on": [
      "convex.lib.twilio.sendMessage",
      "convex._generated.server.d.ActionCtx"
    ],
    "source_code": "async function sendSMS(\n  ctx: ActionCtx,\n  to: string,\n  body: string\n): Promise<void> {\n  await twilio.sendMessage(ctx, {\n    to,\n    body,\n  });\n}",
    "start_line": 93,
    "end_line": 102,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "to",
      "body"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function sendSMS",
    "component_id": "convex.lib.twilio.sendSMS"
  },
  "convex.lib.twilio.getFirstMessageTemplate": {
    "id": "convex.lib.twilio.getFirstMessageTemplate",
    "name": "getFirstMessageTemplate",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/twilio.ts",
    "relative_path": "convex/lib/twilio.ts",
    "depends_on": [],
    "source_code": "function getFirstMessageTemplate(): string {\n  return \"I'm here for family caregivers. We can check in, track burnout, and find local help. Reply YES to start. Reply HELP for help, STOP to opt out. Msg&data rates may apply.\";\n}",
    "start_line": 107,
    "end_line": 109,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getFirstMessageTemplate",
    "component_id": "convex.lib.twilio.getFirstMessageTemplate"
  },
  "convex.lib.twilio.getHelpMessage": {
    "id": "convex.lib.twilio.getHelpMessage",
    "name": "getHelpMessage",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/twilio.ts",
    "relative_path": "convex/lib/twilio.ts",
    "depends_on": [],
    "source_code": "function getHelpMessage(): string {\n  return \"GiveCare helps family caregivers track burnout and find local resources. We send check-ins and can help you find support. Reply STOP to opt out. For immediate crisis support, text 988 or 741741.\";\n}",
    "start_line": 114,
    "end_line": 116,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getHelpMessage",
    "component_id": "convex.lib.twilio.getHelpMessage"
  },
  "convex.lib.twilio.getStopConfirmation": {
    "id": "convex.lib.twilio.getStopConfirmation",
    "name": "getStopConfirmation",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/twilio.ts",
    "relative_path": "convex/lib/twilio.ts",
    "depends_on": [],
    "source_code": "function getStopConfirmation(): string {\n  return \"You've been unsubscribed. Reply YES to resubscribe.\";\n}",
    "start_line": 121,
    "end_line": 123,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getStopConfirmation",
    "component_id": "convex.lib.twilio.getStopConfirmation"
  },
  "convex.lib.twilio.getConsentMessage": {
    "id": "convex.lib.twilio.getConsentMessage",
    "name": "getConsentMessage",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/twilio.ts",
    "relative_path": "convex/lib/twilio.ts",
    "depends_on": [],
    "source_code": "function getConsentMessage(): string {\n  return \"We store your messages to support you. Terms/Privacy: [link]. Reply STOP to opt out.\";\n}",
    "start_line": 128,
    "end_line": 130,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getConsentMessage",
    "component_id": "convex.lib.twilio.getConsentMessage"
  },
  "convex.lib.twilioComponentSchema.defineSchema": {
    "id": "convex.lib.twilioComponentSchema.defineSchema",
    "name": "defineSchema",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/twilioComponentSchema.ts",
    "relative_path": "convex/lib/twilioComponentSchema.ts",
    "depends_on": [
      "convex.lib.twilioComponentSchema.defineSchema"
    ],
    "source_code": "export default defineSchema({\n  messages: defineTable({\n    account_sid: v.string(),\n    api_version: v.string(),\n    body: v.string(),\n    counterparty: v.optional(v.string()),\n    date_created: v.string(),\n    date_sent: v.union(v.string(), v.null()),\n    date_updated: v.union(v.string(), v.null()),\n    direction: v.string(),\n    error_code: v.union(v.number(), v.null()),\n    error_message: v.union(v.string(), v.null()),\n    from: v.string(),\n    messaging_service_sid: v.union(v.string(), v.null()),\n    num_media: v.string(),\n    num_segments: v.string(),\n    price: v.union(v.string(), v.null()),\n    price_unit: v.union(v.string(), v.null()),\n    sid: v.string(),\n    status: v.string(),\n    subresource_uris: v.union(\n      v.object({ media: v.string(), feedback: v.optional(v.string()) }),\n      v.null()\n    ),\n    to: v.string(),\n    uri: v.string(),\n    rest: v.optional(v.any()),\n  })\n    .index(\"by_sid\", [\"account_sid\", \"sid\"])\n    .index(\"by_account_sid\", [\"account_sid\"])\n    .index(\"by_account_sid_and_direction\", [\"account_sid\", \"direction\"])\n    .index(\"by_to\", [\"account_sid\", \"to\"])\n    .index(\"by_from\", [\"account_sid\", \"from\"])\n    .index(\"by_counterparty\", [\"account_sid\", \"counterparty\"]),\n\n  phone_numbers: defineTable({\n    account_sid: v.string(),\n    address_requirements: v.string(),\n    address_sid: v.null(),\n    api_version: v.string(),\n    beta: v.boolean(),\n    bundle_sid: v.null(),\n    capabilities: v.object({\n      fax: v.boolean(),\n      mms: v.boolean(),\n      sms: v.boolean(),\n      voice: v.boolean(),\n    }),\n    date_created: v.string(),\n    date_updated: v.string(),\n    emergency_address_sid: v.null(),\n    emergency_address_status: v.string(),\n    emergency_status: v.string(),\n    friendly_name: v.string(),\n    identity_sid: v.null(),\n    origin: v.string(),\n    phone_number: v.string(),\n    sid: v.string(),\n    sms_application_sid: v.string(),\n    sms_fallback_method: v.string(),\n    sms_fallback_url: v.string(),\n    sms_method: v.string(),\n    sms_url: v.string(),\n    status: v.string(),\n    status_callback: v.string(),\n    status_callback_method: v.string(),\n    subresource_uris: v.object({ assigned_add_ons: v.string() }),\n    trunk_sid: v.null(),\n    uri: v.string(),\n    voice_application_sid: v.string(),\n    voice_caller_id_lookup: v.boolean(),\n    voice_fallback_method: v.string(),\n    voice_fallback_url: v.string(),\n    voice_method: v.string(),\n    voice_url: v.string(),\n  })\n    .index(\"by_phone_number\", [\"account_sid\", \"phone_number\"])\n    .index(\"by_sid\", [\"account_sid\", \"sid\"]),\n});",
    "start_line": 6,
    "end_line": 84,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "export_default_call",
    "base_classes": null,
    "class_name": null,
    "display_name": "export default defineSchema(...)",
    "component_id": "convex.lib.twilioComponentSchema.defineSchema"
  },
  "convex.lib.types.AssessmentType": {
    "id": "convex.lib.types.AssessmentType",
    "name": "AssessmentType",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/types.ts",
    "relative_path": "convex/lib/types.ts",
    "depends_on": [],
    "source_code": "type AssessmentType = \"ema\" | \"sdoh\";",
    "start_line": 9,
    "end_line": 9,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type AssessmentType",
    "component_id": "convex.lib.types.AssessmentType"
  },
  "convex.lib.types.BurnoutBand": {
    "id": "convex.lib.types.BurnoutBand",
    "name": "BurnoutBand",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/types.ts",
    "relative_path": "convex/lib/types.ts",
    "depends_on": [],
    "source_code": "type BurnoutBand = \"very_low\" | \"low\" | \"moderate\" | \"high\";",
    "start_line": 11,
    "end_line": 11,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type BurnoutBand",
    "component_id": "convex.lib.types.BurnoutBand"
  },
  "convex.lib.types.ZoneName": {
    "id": "convex.lib.types.ZoneName",
    "name": "ZoneName",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/types.ts",
    "relative_path": "convex/lib/types.ts",
    "depends_on": [],
    "source_code": "type ZoneName =\n  | \"zone_emotional\"\n  | \"zone_physical\"\n  | \"zone_social\"\n  | \"zone_time\"\n  | \"zone_financial\";",
    "start_line": 13,
    "end_line": 18,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type ZoneName",
    "component_id": "convex.lib.types.ZoneName"
  },
  "convex.lib.types.OnboardingStage": {
    "id": "convex.lib.types.OnboardingStage",
    "name": "OnboardingStage",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/types.ts",
    "relative_path": "convex/lib/types.ts",
    "depends_on": [],
    "source_code": "type OnboardingStage =\n  | \"new\"\n  | \"care_recipient\"\n  | \"primary_stressor\"\n  | \"assessment_offer\"\n  | \"assessment_in_progress\"\n  | \"first_assessment_complete\"\n  | \"resource_discovery_offered\"\n  | \"complete\";",
    "start_line": 20,
    "end_line": 28,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type OnboardingStage",
    "component_id": "convex.lib.types.OnboardingStage"
  },
  "convex.lib.types.OnboardingMilestone": {
    "id": "convex.lib.types.OnboardingMilestone",
    "name": "OnboardingMilestone",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/types.ts",
    "relative_path": "convex/lib/types.ts",
    "depends_on": [],
    "source_code": "interface OnboardingMilestone {\n  milestone: string;\n  completedAt: number;\n}",
    "start_line": 30,
    "end_line": 33,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface OnboardingMilestone",
    "component_id": "convex.lib.types.OnboardingMilestone"
  },
  "convex.lib.types.CrisisDetectionResult": {
    "id": "convex.lib.types.CrisisDetectionResult",
    "name": "CrisisDetectionResult",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/types.ts",
    "relative_path": "convex/lib/types.ts",
    "depends_on": [],
    "source_code": "interface CrisisDetectionResult {\n  isCrisis: boolean;\n  severity?: \"high\" | \"medium\" | \"low\";\n  isFalsePositive: boolean;\n  isDVHint: boolean;\n}",
    "start_line": 35,
    "end_line": 40,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface CrisisDetectionResult",
    "component_id": "convex.lib.types.CrisisDetectionResult"
  },
  "convex.lib.types.ResourceResult": {
    "id": "convex.lib.types.ResourceResult",
    "name": "ResourceResult",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/types.ts",
    "relative_path": "convex/lib/types.ts",
    "depends_on": [],
    "source_code": "interface ResourceResult {\n  placeId: string;\n  name: string;\n  address?: string;\n  types?: string[];\n}",
    "start_line": 42,
    "end_line": 47,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface ResourceResult",
    "component_id": "convex.lib.types.ResourceResult"
  },
  "convex.lib.types.UserMetadata": {
    "id": "convex.lib.types.UserMetadata",
    "name": "UserMetadata",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/types.ts",
    "relative_path": "convex/lib/types.ts",
    "depends_on": [],
    "source_code": "type UserMetadata = Infer<typeof agentMetadataValidator>;",
    "start_line": 49,
    "end_line": 49,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type UserMetadata",
    "component_id": "convex.lib.types.UserMetadata"
  },
  "convex.lib.types.EventPayload": {
    "id": "convex.lib.types.EventPayload",
    "name": "EventPayload",
    "component_type": "type",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/types.ts",
    "relative_path": "convex/lib/types.ts",
    "depends_on": [],
    "source_code": "type EventPayload = Infer<typeof eventPayloadValidator>;",
    "start_line": 51,
    "end_line": 51,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "type_alias",
    "base_classes": null,
    "class_name": null,
    "display_name": "type EventPayload",
    "component_id": "convex.lib.types.EventPayload"
  },
  "convex.lib.userHelpers.requireUser": {
    "id": "convex.lib.userHelpers.requireUser",
    "name": "requireUser",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/userHelpers.ts",
    "relative_path": "convex/lib/userHelpers.ts",
    "depends_on": [
      "convex._generated.dataModel.d.Id"
    ],
    "source_code": "async function requireUser(\n  db: GenericDatabaseReader<any>,\n  userId: Id<\"users\">\n) {\n  const user = await db.get(userId);\n  if (!user) {\n    throw new Error(`User not found: ${String(userId)}`);\n  }\n  return user;\n}",
    "start_line": 7,
    "end_line": 16,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "db",
      "userId"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function requireUser",
    "component_id": "convex.lib.userHelpers.requireUser"
  },
  "convex.lib.utils.CrisisDetectionResult": {
    "id": "convex.lib.utils.CrisisDetectionResult",
    "name": "CrisisDetectionResult",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "interface CrisisDetectionResult {\n  isCrisis: boolean;\n  severity?: \"high\" | \"medium\" | \"low\";\n  isFalsePositive: boolean;\n  isDVHint: boolean;\n}",
    "start_line": 47,
    "end_line": 52,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface CrisisDetectionResult",
    "component_id": "convex.lib.utils.CrisisDetectionResult"
  },
  "convex.lib.utils.getUserMetadata": {
    "id": "convex.lib.utils.getUserMetadata",
    "name": "getUserMetadata",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [
      "convex.lib.types.UserMetadata"
    ],
    "source_code": "function getUserMetadata(user?: { metadata?: UserMetadata | null } | null): UserMetadata {\n  return (user?.metadata as UserMetadata) ?? {};\n}",
    "start_line": 57,
    "end_line": 59,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "user"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getUserMetadata",
    "component_id": "convex.lib.utils.getUserMetadata"
  },
  "convex.lib.utils.detectCrisis": {
    "id": "convex.lib.utils.detectCrisis",
    "name": "detectCrisis",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [
      "convex.lib.utils.CrisisDetectionResult"
    ],
    "source_code": "function detectCrisis(text: string): CrisisDetectionResult {\n  // Check for false positives first (subscription-related)\n  const isFalsePositive = FALSE_POSITIVE_PATTERNS.some((pattern) =>\n    pattern.test(text)\n  );\n\n  if (isFalsePositive) {\n    return {\n      isCrisis: false,\n      isFalsePositive: true,\n      isDVHint: false,\n    };\n  }\n\n  // Check for DV/abuse hints\n  const isDVHint = DV_HINT_PATTERNS.some((pattern) => pattern.test(text));\n\n  // Check crisis patterns (high priority first)\n  for (const [severity, patterns] of Object.entries(CRISIS_PATTERNS)) {\n    for (const pattern of patterns) {\n      if (pattern.test(text)) {\n        return {\n          isCrisis: true,\n          severity: severity as \"high\" | \"medium\" | \"low\",\n          isFalsePositive: false,\n          isDVHint,\n        };\n      }\n    }\n  }\n\n  return {\n    isCrisis: false,\n    isFalsePositive: false,\n    isDVHint,\n  };\n}",
    "start_line": 65,
    "end_line": 101,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function detectCrisis",
    "component_id": "convex.lib.utils.detectCrisis"
  },
  "convex.lib.utils.isStopRequest": {
    "id": "convex.lib.utils.isStopRequest",
    "name": "isStopRequest",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function isStopRequest(text: string): boolean {\n  const stopPatterns = [\n    /\\bstop\\b/i,\n    /\\bunsubscribe\\b/i,\n    /\\bcancel\\b/i,\n    /\\bopt\\s+out\\b/i,\n  ];\n  return stopPatterns.some((pattern) => pattern.test(text));\n}",
    "start_line": 106,
    "end_line": 114,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function isStopRequest",
    "component_id": "convex.lib.utils.isStopRequest"
  },
  "convex.lib.utils.isHelpRequest": {
    "id": "convex.lib.utils.isHelpRequest",
    "name": "isHelpRequest",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function isHelpRequest(text: string): boolean {\n  const helpPatterns = [/\\bhelp\\b/i, /\\binfo\\b/i, /\\bsupport\\b/i];\n  return helpPatterns.some((pattern) => pattern.test(text));\n}",
    "start_line": 119,
    "end_line": 122,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function isHelpRequest",
    "component_id": "convex.lib.utils.isHelpRequest"
  },
  "convex.lib.utils.isResubscribeRequest": {
    "id": "convex.lib.utils.isResubscribeRequest",
    "name": "isResubscribeRequest",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function isResubscribeRequest(text: string): boolean {\n  const resubscribePatterns = [/\\bresubscribe\\b/i];\n  return resubscribePatterns.some((pattern) => pattern.test(text));\n}",
    "start_line": 127,
    "end_line": 130,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function isResubscribeRequest",
    "component_id": "convex.lib.utils.isResubscribeRequest"
  },
  "convex.lib.utils.isSignupRequest": {
    "id": "convex.lib.utils.isSignupRequest",
    "name": "isSignupRequest",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function isSignupRequest(text: string): boolean {\n  const signupPatterns = [\n    /\\bsignup\\b/i,\n    /\\bsign\\s+up\\b/i,\n    /\\bsubscribe\\b/i,\n    /\\bjoin\\b/i,\n    /\\bstart\\b/i,\n  ];\n  return signupPatterns.some((pattern) => pattern.test(text));\n}",
    "start_line": 135,
    "end_line": 144,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function isSignupRequest",
    "component_id": "convex.lib.utils.isSignupRequest"
  },
  "convex.lib.utils.isBillingRequest": {
    "id": "convex.lib.utils.isBillingRequest",
    "name": "isBillingRequest",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function isBillingRequest(text: string): boolean {\n  const billingPatterns = [\n    /\\bbilling\\b/i,\n    /\\baccount\\b/i,\n    /\\bmanage\\b/i,\n    /\\bportal\\b/i,\n  ];\n  return billingPatterns.some((pattern) => pattern.test(text));\n}",
    "start_line": 149,
    "end_line": 157,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function isBillingRequest",
    "component_id": "convex.lib.utils.isBillingRequest"
  },
  "convex.lib.utils.isUpdatePaymentRequest": {
    "id": "convex.lib.utils.isUpdatePaymentRequest",
    "name": "isUpdatePaymentRequest",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function isUpdatePaymentRequest(text: string): boolean {\n  const updatePaymentPatterns = [\n    /\\bupdate\\s*payment\\b/i,\n    /\\bupdatepayment\\b/i,\n    /\\bfix\\s*payment\\b/i,\n    /\\bupdate\\s*card\\b/i,\n    /\\bfix\\s*billing\\b/i,\n  ];\n  return updatePaymentPatterns.some((pattern) => pattern.test(text));\n}",
    "start_line": 162,
    "end_line": 171,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function isUpdatePaymentRequest",
    "component_id": "convex.lib.utils.isUpdatePaymentRequest"
  },
  "convex.lib.utils.isEMACheckInKeyword": {
    "id": "convex.lib.utils.isEMACheckInKeyword",
    "name": "isEMACheckInKeyword",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function isEMACheckInKeyword(text: string): \"daily\" | \"weekly\" | \"pause\" | \"resume\" | null {\n  const upper = text.toUpperCase().trim();\n  \n  if (/\\bDAILY\\b/.test(upper)) {\n    return \"daily\";\n  }\n  if (/\\bWEEKLY\\b/.test(upper)) {\n    return \"weekly\";\n  }\n  if (/\\bPAUSE\\s+CHECKINS?\\b/.test(upper) || /\\bPAUSE\\b/.test(upper)) {\n    return \"pause\";\n  }\n  if (/\\bRESUME\\b/.test(upper)) {\n    return \"resume\";\n  }\n  \n  return null;\n}",
    "start_line": 176,
    "end_line": 193,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function isEMACheckInKeyword",
    "component_id": "convex.lib.utils.isEMACheckInKeyword"
  },
  "convex.lib.utils.isAssessmentAcceptance": {
    "id": "convex.lib.utils.isAssessmentAcceptance",
    "name": "isAssessmentAcceptance",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function isAssessmentAcceptance(text: string): boolean {\n  const acceptPatterns = [\n    /\\b(yes|ok|sure|yeah|yep|alright|okay)\\b/i,\n    /\\bstart\\b/i,\n    /\\bgo\\b/i,\n    /\\blet'?s\\s+go\\b/i,\n  ];\n  return acceptPatterns.some((pattern) => pattern.test(text));\n}",
    "start_line": 198,
    "end_line": 206,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function isAssessmentAcceptance",
    "component_id": "convex.lib.utils.isAssessmentAcceptance"
  },
  "convex.lib.utils.extractCareRecipient": {
    "id": "convex.lib.utils.extractCareRecipient",
    "name": "extractCareRecipient",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function extractCareRecipient(\n  text: string\n): { recipient?: string; condition?: string } {\n  // Simple extraction patterns\n  const recipientPatterns = [\n    /\\b(my\\s+)?(mom|mother|mama|mum)\\b/i,\n    /\\b(my\\s+)?(dad|father|papa|pop)\\b/i,\n    /\\b(my\\s+)?(spouse|husband|wife|partner)\\b/i,\n    /\\b(my\\s+)?(son|daughter|child|kid)\\b/i,\n    /\\b(my\\s+)?(sister|brother|sibling)\\b/i,\n  ];\n\n  const conditionPatterns = [\n    /\\bAlzheimer'?s\\b/i,\n    /\\bdementia\\b/i,\n    /\\bcancer\\b/i,\n    /\\bdiabetes\\b/i,\n    /\\bheart\\s+disease\\b/i,\n    /\\bstroke\\b/i,\n  ];\n\n  let recipient: string | undefined;\n  let condition: string | undefined;\n\n  for (const pattern of recipientPatterns) {\n    const match = text.match(pattern);\n    if (match) {\n      recipient = match[0].replace(/^my\\s+/i, \"\").toLowerCase();\n      break;\n    }\n  }\n\n  for (const pattern of conditionPatterns) {\n    const match = text.match(pattern);\n    if (match) {\n      condition = match[0];\n      break;\n    }\n  }\n\n  return { recipient, condition };\n}",
    "start_line": 211,
    "end_line": 252,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function extractCareRecipient",
    "component_id": "convex.lib.utils.extractCareRecipient"
  },
  "convex.lib.utils.getCrisisResponse": {
    "id": "convex.lib.utils.getCrisisResponse",
    "name": "getCrisisResponse",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function getCrisisResponse(isDVHint: boolean): string {\n  // 158 chars - fits in single SMS segment\n  const baseResponse =\n    \"You're not alone. 24/7 support: call/text 988 (lifeline) or text HOME to 741741. Immediate danger? Call 911. Help is here.\";\n\n  if (isDVHint) {\n    // 147 chars - fits in single SMS segment\n    return \"You're not alone. 24/7 support: call/text 988 or text HOME to 741741. Can't safely reply? Call 911. Help is here.\";\n  }\n\n  return baseResponse;\n}",
    "start_line": 259,
    "end_line": 270,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "isDVHint"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function getCrisisResponse",
    "component_id": "convex.lib.utils.getCrisisResponse"
  },
  "convex.lib.utils.normalizePhone": {
    "id": "convex.lib.utils.normalizePhone",
    "name": "normalizePhone",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function normalizePhone(phoneNumber: string): string {\n  if (phoneNumber.startsWith(\"+\")) {\n    // Already E.164 format\n    return phoneNumber;\n  }\n\n  const digits = phoneNumber.replace(/\\D/g, \"\");\n  if (digits.length === 10) {\n    // US 10-digit number  +1 prefix\n    return `+1${digits}`;\n  }\n  if (digits.length === 11 && digits[0] === \"1\") {\n    // US 11-digit number with leading country code\n    return `+${digits}`;\n  }\n\n  // Fallback: use as-is if it doesn't match expected patterns\n  return phoneNumber;\n}",
    "start_line": 276,
    "end_line": 294,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "phoneNumber"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function normalizePhone",
    "component_id": "convex.lib.utils.normalizePhone"
  },
  "convex.lib.utils.detectSelfSacrifice": {
    "id": "convex.lib.utils.detectSelfSacrifice",
    "name": "detectSelfSacrifice",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function detectSelfSacrifice(text: string): boolean {\n  const patterns = [\n    /\\bI\\s+can'?t\\s+(?:ever\\s+)?rest\\b/i,\n    /\\bI\\s+don'?t\\s+deserve\\s+help\\b/i,\n    /\\bI\\s+should\\s+always\\s+put\\s+others\\s+first\\b/i,\n    /\\bI\\s+can'?t\\s+take\\s+a\\s+break\\b/i,\n    /\\bI\\s+must\\s+always\\s+be\\s+there\\b/i,\n    /\\bI\\s+can'?t\\s+be\\s+selfish\\b/i,\n  ];\n  return patterns.some((pattern) => pattern.test(text));\n}",
    "start_line": 299,
    "end_line": 309,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function detectSelfSacrifice",
    "component_id": "convex.lib.utils.detectSelfSacrifice"
  },
  "convex.lib.utils.detectReassuranceLoop": {
    "id": "convex.lib.utils.detectReassuranceLoop",
    "name": "detectReassuranceLoop",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function detectReassuranceLoop(text: string): boolean {\n  const patterns = [\n    /\\bare\\s+you\\s+sure\\b/i,\n    /\\bwhat\\s+if\\b/i,\n    /\\bbut\\s+what\\s+about\\b/i,\n    /\\bare\\s+you\\s+certain\\b/i,\n  ];\n  return patterns.some((pattern) => pattern.test(text));\n}",
    "start_line": 314,
    "end_line": 322,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function detectReassuranceLoop",
    "component_id": "convex.lib.utils.detectReassuranceLoop"
  },
  "convex.lib.utils.extractZipFromQuery": {
    "id": "convex.lib.utils.extractZipFromQuery",
    "name": "extractZipFromQuery",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function extractZipFromQuery(query: string): string | null {\n  const zipMatch = query.match(/\\b\\d{5}\\b/);\n  return zipMatch ? zipMatch[0] : null;\n}",
    "start_line": 327,
    "end_line": 330,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "query"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function extractZipFromQuery",
    "component_id": "convex.lib.utils.extractZipFromQuery"
  },
  "convex.lib.utils.extractProfileData": {
    "id": "convex.lib.utils.extractProfileData",
    "name": "extractProfileData",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/lib/utils.ts",
    "relative_path": "convex/lib/utils.ts",
    "depends_on": [],
    "source_code": "function extractProfileData(message: string): Record<string, string> {\n  const extracted: Record<string, string> = {};\n\n  // Extract ZIP code (5 digits, optionally with context words)\n  const zipPatterns = [\n    /\\b(\\d{5})(?:-\\d{4})?\\b/,  // Standalone 5-digit ZIP\n    /(?:zip|ZIP|zip code|zipcode|in)\\s*[:\\s]*(\\d{5})/i,  // \"in 90210\", \"ZIP: 90210\"\n    /I(?:'m| am) in (\\d{5})/i,  // \"I'm in 90210\"\n    /help in (\\d{5})/i,  // \"help in 90210\"\n  ];\n\n  for (const pattern of zipPatterns) {\n    const match = message.match(pattern);\n    if (match && match[1]) {\n      extracted.zipCode = match[1];\n      break; // Use first match\n    }\n  }\n\n  // Extract first name (common self-introduction patterns)\n  const firstNamePatterns = [\n    /(?:I'm|I am|my name is|call me|this is)\\s+([A-Z][a-z]+)/i,\n    /^([A-Z][a-z]+)\\s+here/i,  // \"Sarah here\"\n  ];\n\n  for (const pattern of firstNamePatterns) {\n    const match = message.match(pattern);\n    if (match && match[1]) {\n      // Filter out common false positives\n      const name = match[1].toLowerCase();\n      if (!['help', 'caring', 'looking', 'need', 'want', 'trying'].includes(name)) {\n        extracted.firstName = match[1];\n        break;\n      }\n    }\n  }\n\n  // Extract care recipient name (common family role patterns)\n  const careRecipientPatterns = [\n    /caring for (?:my\\s+)?([a-z]+)/i,  // \"caring for mom\", \"caring for my dad\"\n    /taking care of (?:my\\s+)?([a-z]+)/i,\n    /(?:help|looking after|watching)\\s+(?:my\\s+)?([a-z]+)/i,\n  ];\n\n  for (const pattern of careRecipientPatterns) {\n    const match = message.match(pattern);\n    if (match && match[1]) {\n      const recipient = match[1].toLowerCase();\n      // Only save if it's a common family role\n      if (['mom', 'dad', 'mother', 'father', 'husband', 'wife', 'partner', 'sister', 'brother', 'grandmother', 'grandfather', 'grandma', 'grandpa'].includes(recipient)) {\n        extracted.careRecipientName = recipient;\n        break;\n      }\n    }\n  }\n\n  return extracted;\n}",
    "start_line": 337,
    "end_line": 394,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "message"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function extractProfileData",
    "component_id": "convex.lib.utils.extractProfileData"
  },
  "convex.public.checkAdminAccess": {
    "id": "convex.public.checkAdminAccess",
    "name": "checkAdminAccess",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/public.ts",
    "relative_path": "convex/public.ts",
    "depends_on": [],
    "source_code": "async function checkAdminAccess(ctx: any): Promise<void> {\n  const identity = await ctx.auth.getUserIdentity();\n  if (!identity) {\n    throw new Error(\"Unauthorized: Authentication required\");\n  }\n\n  const email = identity.email;\n  if (!email || !ADMIN_EMAILS.includes(email)) {\n    throw new Error(\"Unauthorized: Admin access only. Contact administrator to request access.\");\n  }\n}",
    "start_line": 92,
    "end_line": 102,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function checkAdminAccess",
    "component_id": "convex.public.checkAdminAccess"
  },
  "convex.resources.cacheKey": {
    "id": "convex.resources.cacheKey",
    "name": "cacheKey",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/resources.ts",
    "relative_path": "convex/resources.ts",
    "depends_on": [],
    "source_code": "function cacheKey(intent: any, zip: string | null): string {\n  const intentLabel = intent?.intent || \"general\";\n  const topZone = Array.isArray(intent?.sdohZones) ? intent.sdohZones[0] || \"\" : \"\";\n  return `${zip || \"national\"}|${intentLabel}|${topZone}`.toLowerCase();\n}",
    "start_line": 24,
    "end_line": 28,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "intent",
      "zip"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function cacheKey",
    "component_id": "convex.resources.cacheKey"
  },
  "convex.resources.isCacheValid": {
    "id": "convex.resources.isCacheValid",
    "name": "isCacheValid",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/resources.ts",
    "relative_path": "convex/resources.ts",
    "depends_on": [],
    "source_code": "function isCacheValid(entry: any): boolean {\n  return !entry?.expiresAt || entry.expiresAt > Date.now();\n}",
    "start_line": 30,
    "end_line": 32,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "entry"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function isCacheValid",
    "component_id": "convex.resources.isCacheValid"
  },
  "convex.resources.searchLocalResources": {
    "id": "convex.resources.searchLocalResources",
    "name": "searchLocalResources",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/resources.ts",
    "relative_path": "convex/resources.ts",
    "depends_on": [
      "convex.resources.formatMapsResponse",
      "convex.lib.maps.searchWithMapsGrounding",
      "convex.resources.searchNationalResources"
    ],
    "source_code": "async function searchLocalResources(\n  intent: any,\n  location: { zipCode: string; latitude?: number; longitude?: number }\n): Promise<any> {\n  let lastError: Error | null = null;\n\n  // Try each search tier (specific  general)\n  for (const tier of intent.searchTiers) {\n    try {\n      const result = await searchWithMapsGrounding(tier, location);\n\n      // Success! Return formatted results\n      return {\n        resources: formatMapsResponse(result.text, intent),\n        sources: result.resources.map((r: any) => ({\n          placeId: r.placeId,\n          name: r.name,\n          address: r.address,\n        })),\n        widgetToken: result.widgetToken,\n        intent: {\n          zones: intent.sdohZones,\n          reasoning: intent.reasoning,\n        },\n      };\n    } catch (error) {\n      console.log(`Maps search tier failed: ${tier}`, error);\n      lastError = error as Error;\n      // If Maps returns a clear \"no results\" signal, fall back early\n      const message = (lastError as Error).message || String(lastError);\n      if (message.includes(\"No Maps Grounding results found\")) {\n        break;\n      }\n      continue; // Try next tier for transient errors\n    }\n  }\n\n  // All tiers failed or no local results - fall back to national search\n  try {\n    return await searchNationalResources(intent);\n  } catch (nationalError) {\n    // Preserve original Maps error when available\n    throw lastError || (nationalError as Error);\n  }\n}",
    "start_line": 113,
    "end_line": 157,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "intent",
      "location"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function searchLocalResources",
    "component_id": "convex.resources.searchLocalResources"
  },
  "convex.resources.searchNationalResources": {
    "id": "convex.resources.searchNationalResources",
    "name": "searchNationalResources",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/resources.ts",
    "relative_path": "convex/resources.ts",
    "depends_on": [
      "convex.resources.formatNationalResponse",
      "convex.lib.search.tieredSearch"
    ],
    "source_code": "async function searchNationalResources(intent: any): Promise<any> {\n  try {\n    // Use tiered search with Gemini (Search Grounding optional)\n    const result = await tieredSearch(\n      intent.searchTiers,\n      false // Set to true to enable Search Grounding (if available)\n    );\n\n    return {\n      resources: formatNationalResponse(result.text, intent),\n      sources: result.sources.length > 0 ? result.sources : undefined,\n      intent: {\n        zones: intent.sdohZones,\n        reasoning: intent.reasoning,\n      },\n      message: \"These are online resources. Share your ZIP code for local options.\",\n    };\n  } catch (error) {\n    throw new Error(`National search failed: ${(error as Error).message}`);\n  }\n}",
    "start_line": 163,
    "end_line": 183,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "intent"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function searchNationalResources",
    "component_id": "convex.resources.searchNationalResources"
  },
  "convex.resources.formatMapsResponse": {
    "id": "convex.resources.formatMapsResponse",
    "name": "formatMapsResponse",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/resources.ts",
    "relative_path": "convex/resources.ts",
    "depends_on": [],
    "source_code": "function formatMapsResponse(text: string, intent: any): string {\n  const zoneContext = intent.sdohZones.length > 0\n    ? `\\n\\nRelated to: ${intent.sdohZones.map(getZoneDisplayName).join(\", \")}`\n    : \"\";\n\n  return `${text}${zoneContext}`;\n}",
    "start_line": 189,
    "end_line": 195,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text",
      "intent"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function formatMapsResponse",
    "component_id": "convex.resources.formatMapsResponse"
  },
  "convex.resources.formatNationalResponse": {
    "id": "convex.resources.formatNationalResponse",
    "name": "formatNationalResponse",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/resources.ts",
    "relative_path": "convex/resources.ts",
    "depends_on": [],
    "source_code": "function formatNationalResponse(text: string, intent: any): string {\n  const zoneContext = intent.sdohZones.length > 0\n    ? `\\n\\nThese address: ${intent.sdohZones.map(getZoneDisplayName).join(\", \")}`\n    : \"\";\n\n  return `${text}${zoneContext}\\n\\nShare your ZIP for local options.`;\n}",
    "start_line": 201,
    "end_line": 207,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "text",
      "intent"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function formatNationalResponse",
    "component_id": "convex.resources.formatNationalResponse"
  },
  "convex.resources.getCachedResources": {
    "id": "convex.resources.getCachedResources",
    "name": "getCachedResources",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/resources.ts",
    "relative_path": "convex/resources.ts",
    "depends_on": [
      "convex.resources.isCacheValid"
    ],
    "source_code": "async function getCachedResources(ctx: any, cacheKeyValue: string) {\n  const cached = await ctx.db\n    .query(\"resource_cache\")\n    .withIndex(\"by_zip_cat\", (q: any) => q.eq(\"zip\", cacheKeyValue).eq(\"category\", cacheKeyValue))\n    .first();\n\n  if (cached && isCacheValid(cached)) {\n    return {\n      resources: (cached.results as any)?.resourcesText || cached.results,\n      sources: (cached.results as any)?.sources || cached.placeIds?.map((placeId: string) => ({ placeId, name: \"Saved result\" })),\n      intent: {},\n      message: \"Sharing saved options. Reply with your ZIP for fresher local results.\",\n    };\n  }\n\n  return null;\n}",
    "start_line": 209,
    "end_line": 225,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "cacheKeyValue"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function getCachedResources",
    "component_id": "convex.resources.getCachedResources"
  },
  "convex.resources.writeResourceCache": {
    "id": "convex.resources.writeResourceCache",
    "name": "writeResourceCache",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/resources.ts",
    "relative_path": "convex/resources.ts",
    "depends_on": [],
    "source_code": "async function writeResourceCache(\n  ctx: any,\n  cacheKeyValue: string,\n  payload: { resourcesText: string; sources?: Array<{ placeId?: string; name?: string; address?: string }> }\n) {\n  const existing = await ctx.db\n    .query(\"resource_cache\")\n    .withIndex(\"by_zip_cat\", (q: any) => q.eq(\"zip\", cacheKeyValue).eq(\"category\", cacheKeyValue))\n    .first();\n\n  const doc = {\n    category: cacheKeyValue,\n    zip: cacheKeyValue,\n    placeIds: payload.sources?.map((s) => s.placeId).filter(Boolean),\n    results: payload,\n    createdAt: Date.now(),\n    expiresAt: Date.now() + CACHE_TTL_MS,\n  };\n\n  if (existing?._id) {\n    await ctx.db.patch(existing._id, doc);\n  } else {\n    await ctx.db.insert(\"resource_cache\", doc);\n  }\n}",
    "start_line": 227,
    "end_line": 251,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "ctx",
      "cacheKeyValue",
      "payload"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function writeResourceCache",
    "component_id": "convex.resources.writeResourceCache"
  },
  "convex.schema.defineSchema": {
    "id": "convex.schema.defineSchema",
    "name": "defineSchema",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/schema.ts",
    "relative_path": "convex/schema.ts",
    "depends_on": [
      "convex.schema.defineSchema"
    ],
    "source_code": "export default defineSchema({\n  ...authTables,\n\n  // Users - User profiles\n  users: defineTable({\n    externalId: v.string(), // Phone number or email\n    phone: v.optional(v.string()),\n    email: v.optional(v.string()),\n    name: v.optional(v.string()),\n    channel: v.optional(v.union(v.literal(\"sms\"), v.literal(\"email\"), v.literal(\"web\"))),\n    locale: v.optional(v.string()),\n    consent: v.optional(consentValidator),\n    address: v.optional(addressValidator),\n    metadata: v.optional(agentMetadataValidator),\n    lastEngagementDate: v.optional(v.number()),\n    // Score-centric fields (also stored in metadata for backward compatibility)\n    gcSdohScore: v.optional(v.number()), // GC-SDOH Score (0-100)\n    zones: v.optional(zonesValidator), // P1-P6 zone scores\n    riskLevel: v.optional(v.union(v.literal(\"low\"), v.literal(\"moderate\"), v.literal(\"high\"), v.literal(\"crisis\"))),\n    lastEMA: v.optional(v.number()),\n    lastSDOH: v.optional(v.number()),\n    emaEnabled: v.optional(v.boolean()),\n    zipCode: v.optional(v.string()),\n  })\n    .index(\"by_externalId\", [\"externalId\"])\n    .index(\"by_phone\", [\"phone\"]),\n\n  // Assessments - Completed assessments (EMA + SDOH only)\n  assessments: defineTable({\n    userId: v.id(\"users\"),\n    definitionId: v.union(\n      v.literal(\"ema\"),\n      v.literal(\"sdoh\")\n    ),\n    version: v.string(),\n    answers: v.array(\n      v.object({\n        questionId: v.string(),\n        value: v.number(),\n      })\n    ),\n    rawScores: v.optional(v.any()), // Instrument-native scores per domain\n    completedAt: v.number(),\n  })\n    .index(\"by_user\", [\"userId\"])\n    .index(\"by_user_and_type\", [\"userId\", \"definitionId\"]),\n\n  // Scores - Burnout scores (raw + normalized) - EMA + SDOH only\n  scores: defineTable({\n    userId: v.id(\"users\"),\n    assessmentId: v.id(\"assessments\"),\n    instrument: v.union(\n      v.literal(\"ema\"),\n      v.literal(\"sdoh\")\n    ),\n    rawComposite: v.number(), // Instrument-native score\n    gcBurnout: v.number(), // Normalized GiveCare score (0-100)\n    band: v.union(\n      v.literal(\"very_low\"),\n      v.literal(\"low\"),\n      v.literal(\"moderate\"),\n      v.literal(\"high\")\n    ),\n    zones: zonesValidator, // P1-P6 zone scores\n    confidence: v.number(), // 0-1: answered_ratio for partial assessments\n    answeredRatio: v.number(), // answered / total questions\n  })\n    .index(\"by_user_and_type\", [\"userId\", \"instrument\"])\n    .index(\"by_user\", [\"userId\"])\n    .index(\"by_user_and_assessment\", [\"userId\", \"assessmentId\"]),\n\n  // Score history - Track score changes over time\n  score_history: defineTable({\n    userId: v.id(\"users\"),\n    oldScore: v.number(), // Previous score\n    newScore: v.number(), // New score\n    zones: zonesValidator, // Zone snapshot at time of change\n    trigger: v.union(v.literal(\"ema\"), v.literal(\"sdoh\"), v.literal(\"observation\")),\n    timestamp: v.number(),\n  })\n    .index(\"by_user\", [\"userId\"])\n    .index(\"by_timestamp\", [\"timestamp\"]),\n\n  // Scores composite - Composite burnout score history (for trend charts)\n  scores_composite: defineTable({\n    userId: v.id(\"users\"),\n    gcBurnout: v.number(), // Composite score (0-100)\n    band: v.string(), // very_low | low | moderate | high\n  })\n    .index(\"by_user\", [\"userId\"]),\n\n  // Assessment sessions - In-progress assessments\n  assessment_sessions: defineTable({\n    userId: v.id(\"users\"),\n    definitionId: v.string(),\n    channel: v.union(v.literal(\"sms\"), v.literal(\"web\")),\n    questionIndex: v.number(),\n    answers: v.array(\n      v.object({\n        questionId: v.string(),\n        value: v.number(),\n      })\n    ),\n    status: v.union(v.literal(\"active\"), v.literal(\"completed\")),\n  })\n    .index(\"by_user_status\", [\"userId\", \"status\"])\n    .index(\"by_user_and_type\", [\"userId\", \"definitionId\"]),\n\n  // Interventions - Evidence-based interventions\n  interventions: defineTable({\n    title: v.string(),\n    description: v.string(),\n    category: v.string(),\n    targetZones: v.array(v.string()), // Kept for backward compatibility\n    evidenceLevel: v.union(\n      v.literal(\"high\"),\n      v.literal(\"moderate\"),\n      v.literal(\"low\")\n    ),\n    duration: v.string(), // e.g., \"2-5 min\"\n    tags: v.array(v.string()),\n    content: v.string(), // Instructions\n  })\n    .index(\"by_category\", [\"category\"])\n    .index(\"by_evidence\", [\"evidenceLevel\"]),\n\n  // Intervention zones - Join table for zone-based queries\n  intervention_zones: defineTable({\n    interventionId: v.id(\"interventions\"),\n    zone: v.string(), // 'emotional', 'physical', 'social', 'time', 'financial'\n  })\n    .index(\"by_zone\", [\"zone\"])\n    .index(\"by_intervention\", [\"interventionId\"]),\n\n  // Intervention events - User interaction tracking (DEPRECATED: use events table)\n  intervention_events: defineTable({\n    userId: v.id(\"users\"),\n    interventionId: v.string(),\n    status: v.string(),\n    metadata: v.optional(v.any()),\n  }).index(\"by_user\", [\"userId\"]),\n\n  // Events - Generic event log for learning loop (replaces intervention_events)\n  events: defineTable({\n    userId: v.id(\"users\"),\n    type: v.union(\n      v.literal(\"intervention.try\"),\n      v.literal(\"intervention.success\"),\n      v.literal(\"intervention.skip\"),\n      v.literal(\"resource.open\"),\n      v.literal(\"resource.search\"),\n      v.literal(\"assessment.completed\"),\n      v.literal(\"assessment.started\"),\n      v.literal(\"profile.updated\"),\n      v.literal(\"memory.recorded\"),\n      v.literal(\"check_in.completed\"),\n      v.literal(\"sms.missing_phone\")\n    ),\n    payload: eventPayloadValidator, // Flexible payload for event-specific data (typed)\n  })\n    .index(\"by_user\", [\"userId\"])\n    .index(\"by_type\", [\"type\"]),\n\n  // Subscriptions - Stripe subscriptions\n  subscriptions: defineTable({\n    userId: v.id(\"users\"),\n    stripeCustomerId: v.string(),\n    planId: v.union(v.literal(\"monthly\"), v.literal(\"annual\")),\n    status: v.union(\n      v.literal(\"active\"),\n      v.literal(\"canceled\"),\n      v.literal(\"past_due\")\n    ),\n    currentPeriodEnd: v.number(),\n    canceledAt: v.optional(v.number()),\n    gracePeriodEndsAt: v.optional(v.number()),\n  })\n    .index(\"by_user\", [\"userId\"])\n    .index(\"by_user_status\", [\"userId\", \"status\"])\n    .index(\"by_customer\", [\"stripeCustomerId\"]),\n\n  // Memories - User context memories\n  memories: defineTable({\n    userId: v.id(\"users\"),\n    category: v.union(\n      v.literal(\"care_routine\"),\n      v.literal(\"preference\"),\n      v.literal(\"intervention_result\"),\n      v.literal(\"crisis_trigger\"),\n      v.literal(\"family_health\")\n    ),\n    content: v.string(),\n    importance: v.number(), // 1-10\n  })\n    .index(\"by_user_and_importance\", [\"userId\", \"importance\"])\n    .index(\"by_user_category\", [\"userId\", \"category\"]),\n\n  // Resource cache - Google Maps results cache (policy-compliant: place_id only)\n  resource_cache: defineTable({\n    category: v.string(),\n    zip: v.string(),\n    placeIds: v.optional(v.array(v.string())), // Only place_id, name, types, createdAt\n    createdAt: v.number(),\n    expiresAt: v.optional(v.number()),\n    // Legacy field\n    results: v.optional(v.any()),\n  })\n    .index(\"by_zip_cat\", [\"zip\", \"category\"])\n    .index(\"by_expiresAt\", [\"expiresAt\"]),\n\n  // Triggers - Scheduled check-ins\n  triggers: defineTable({\n    userId: v.id(\"users\"),\n    userExternalId: v.string(),\n    rrule: v.string(), // iCal RRULE\n    timezone: v.string(),\n    nextRun: v.number(),\n    payload: v.any(),\n    type: v.union(v.literal(\"recurring\"), v.literal(\"one_off\")),\n    status: v.union(v.literal(\"active\"), v.literal(\"paused\")),\n  })\n    .index(\"by_user\", [\"userId\"])\n    .index(\"by_nextRun\", [\"nextRun\"]),\n\n  // Alerts - Crisis alerts and notifications\n  alerts: defineTable({\n    userId: v.id(\"users\"),\n    type: v.string(),\n    severity: v.union(\n      v.literal(\"low\"),\n      v.literal(\"medium\"),\n      v.literal(\"high\"),\n      v.literal(\"critical\")\n    ),\n    context: v.any(),\n    message: v.string(),\n    channel: v.union(v.literal(\"sms\"), v.literal(\"email\")),\n    status: v.union(v.literal(\"pending\"), v.literal(\"processed\")),\n  })\n    .index(\"by_user\", [\"userId\"])\n    .index(\"by_severity\", [\"severity\"])\n    .index(\"by_type\", [\"type\"]),\n\n  // Billing events - Stripe webhook idempotency\n  billing_events: defineTable({\n    stripeEventId: v.string(),\n    userId: v.optional(v.id(\"users\")),\n    type: v.string(),\n    data: v.any(),\n  }).index(\"by_event\", [\"stripeEventId\"]),\n\n  // Inbound receipts - Twilio message idempotency (fields optional for migration)\n  inbound_receipts: defineTable({\n    messageSid: v.string(), // Unique Twilio MessageSid\n    userId: v.optional(v.id(\"users\")),\n    receivedAt: v.optional(v.number()),\n  })\n    .index(\"by_messageSid\", [\"messageSid\"]) // Unique index\n    .index(\"by_user\", [\"userId\"]),\n\n  // Agent runs - Agent execution tracking\n  // Preferred fields: agentName, threadId, toolCalls, createdAt\n  // Legacy fields (deprecated): agent, budgetResult, latencyMs, policyBundle, traceId\n  // Note: Records are created via usageHandler in agents.ts (see internal/agentRuns.ts)\n  agent_runs: defineTable({\n    userId: v.id(\"users\"),\n    // Preferred: Use agentName instead of agent\n    agentName: v.optional(v.union(v.literal(\"main\"), v.literal(\"assessment\"), v.literal(\"crisis\"))),\n    threadId: v.optional(v.string()), // Thread ID from Agent Component (managed separately)\n    toolCalls: v.optional(v.array(v.any())),\n    createdAt: v.optional(v.number()),\n    // Legacy fields (deprecated - use agentName, createdAt instead)\n    agent: v.optional(v.string()),\n    budgetResult: v.optional(v.any()),\n    latencyMs: v.optional(v.number()),\n    policyBundle: v.optional(v.string()),\n    traceId: v.optional(v.string()),\n  }).index(\"by_user\", [\"userId\"]),\n\n  // Guardrail events - Safety guardrail triggers\n  guardrail_events: defineTable({\n    userId: v.optional(v.id(\"users\")),\n    type: v.union(\n      v.literal(\"crisis\"),\n      v.literal(\"false_positive\"),\n      v.literal(\"dv_hint\"),\n      v.literal(\"crisis_followup_sent\"),\n      v.literal(\"stress_spike_followup_sent\"),\n      v.literal(\"reassurance_loop\"),\n      v.literal(\"self_sacrifice\")\n    ),\n    severity: v.union(\n      v.literal(\"low\"),\n      v.literal(\"medium\"),\n      v.literal(\"high\")\n    ),\n    context: v.any(),\n    createdAt: v.number(),\n  })\n    .index(\"by_user\", [\"userId\"])\n    .index(\"by_user_createdAt\", [\"userId\", \"createdAt\"])\n    .index(\"by_severity\", [\"severity\"]),\n\n  // Conversation feedback - User feedback on AI responses\n  conversation_feedback: defineTable({\n    userId: v.id(\"users\"),\n    agentRunId: v.optional(v.id(\"agent_runs\")),\n    alertId: v.optional(v.id(\"alerts\")), // Link to crisis alert if applicable\n    helpful: v.boolean(),\n    reason: v.optional(v.string()), // \"too_generic\", \"didnt_understand\", \"perfect\", \"other\"\n    createdAt: v.number(),\n  })\n    .index(\"by_user\", [\"userId\"])\n    .index(\"by_alert\", [\"alertId\"])\n    .index(\"by_helpful\", [\"helpful\"]),\n\n  // Crisis feedback - Specific feedback for crisis interventions\n  crisis_feedback: defineTable({\n    userId: v.id(\"users\"),\n    alertId: v.id(\"alerts\"), // Link to original crisis alert\n    connectedWith988: v.optional(v.boolean()), // Did they connect with crisis hotline?\n    wasHelpful: v.optional(v.boolean()), // Was the response helpful?\n    followUpResponse: v.optional(v.string()), // Their verbatim response\n    createdAt: v.number(),\n  })\n    .index(\"by_user\", [\"userId\"])\n    .index(\"by_alert\", [\"alertId\"])\n    .index(\"by_connected\", [\"connectedWith988\"]),\n\n  // Session metrics - Aggregate metrics per conversation session\n  session_metrics: defineTable({\n    userId: v.id(\"users\"),\n    threadId: v.optional(v.string()), // Agent thread ID if applicable\n    startedAt: v.number(),\n    endedAt: v.optional(v.number()),\n    messageCount: v.number(),\n    assessmentCompleted: v.optional(v.boolean()),\n    crisisDetected: v.optional(v.boolean()),\n    userReturnedNext24h: v.optional(v.boolean()), // Calculated retroactively\n    avgResponseTimeMs: v.optional(v.number()),\n  })\n    .index(\"by_user\", [\"userId\"])\n    .index(\"by_thread\", [\"threadId\"])\n    .index(\"by_started\", [\"startedAt\"]),\n\n  // LLM usage - token accounting\n  llm_usage: defineTable({\n    userId: v.optional(v.id(\"users\")),\n    agentName: v.optional(v.union(v.literal(\"main\"), v.literal(\"assessment\"), v.literal(\"crisis\"))),\n    model: v.string(),\n    provider: v.string(),\n    promptTokens: v.number(),\n    completionTokens: v.number(),\n    totalTokens: v.number(),\n    createdAt: v.number(),\n  })\n    .index(\"by_user_created\", [\"userId\", \"createdAt\"])\n    .index(\"by_created\", [\"createdAt\"]),\n\n  // Usage invoices - rollups\n  usage_invoices: defineTable({\n    userId: v.id(\"users\"),\n    billingPeriod: v.string(), // e.g., 2025-01\n    totalTokens: v.number(),\n    totalCost: v.number(),\n    status: v.union(v.literal(\"open\"), v.literal(\"paid\"), v.literal(\"void\")),\n  }).index(\"by_user_period\", [\"userId\", \"billingPeriod\"]),\n\n  // Entitlements\n  entitlements: defineTable({\n    userId: v.id(\"users\"),\n    feature: v.string(),\n    active: v.boolean(),\n    expiresAt: v.optional(v.number()),\n  }).index(\"by_user_feature\", [\"userId\", \"feature\"]),\n\n  // Prompt versions (for future A/B and audit)\n  prompt_versions: defineTable({\n    name: v.string(),\n    version: v.string(),\n    prompt: v.string(),\n    createdAt: v.number(),\n  }).index(\"by_name_version\", [\"name\", \"version\"]),\n\n  // Tool call telemetry\n  tool_calls: defineTable({\n    userId: v.optional(v.id(\"users\")),\n    agentName: v.optional(v.string()),\n    name: v.string(),\n    durationMs: v.optional(v.number()),\n    success: v.boolean(),\n    cost: v.optional(v.number()),\n    createdAt: v.number(),\n  })\n    .index(\"by_user_created\", [\"userId\", \"createdAt\"])\n    .index(\"by_name\", [\"name\"]),\n\n  // Watcher state - cron cursors\n  watcher_state: defineTable({\n    watcherName: v.string(),\n    cursor: v.optional(v.any()),\n    lastRun: v.optional(v.number()),\n  }).index(\"by_watcher\", [\"watcherName\"]),\n});",
    "start_line": 30,
    "end_line": 433,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "export_default_call",
    "base_classes": null,
    "class_name": null,
    "display_name": "export default defineSchema(...)",
    "component_id": "convex.schema.defineSchema"
  },
  "convex.test.setup.initConvexTest": {
    "id": "convex.test.setup.initConvexTest",
    "name": "initConvexTest",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/convex/test.setup.ts",
    "relative_path": "convex/test.setup.ts",
    "depends_on": [],
    "source_code": "function initConvexTest() {\n  // Initialize test with schema and modules\n  // In monorepo, we must pass modules explicitly because convex-test\n  // may not find convex/ relative to hoisted node_modules\n  // Environment variables are loaded via vitest.config.ts (dotenv + test.env)\n  // and are available through process.env in the test environment\n  // \n  // CRITICAL: _generated directory must exist when import.meta.glob is evaluated\n  // This is ensured by running 'convex codegen' BEFORE Vitest starts\n  const t = convexTest(schema, modules);\n\n  // Register components used by the app\n  // Use custom globs that include *_generated/*.js artifacts required by convex-test\n  t.registerComponent('agent', agentTest.schema, agentComponentModules);\n  t.registerComponent('workflow', workflowTest.schema, workflowComponentModules);\n  t.registerComponent('rateLimiter', rateLimiterTest.schema, rateLimiterComponentModules);\n\n  // Register Twilio component (no-op schema but required tables for stub SMS)\n  t.registerComponent('twilio', twilioSchema, twilioComponentModules);\n\n  return t;\n}",
    "start_line": 65,
    "end_line": 86,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function initConvexTest",
    "component_id": "convex.test.setup.initConvexTest"
  },
  "scripts.analyze-test-results.TestFailure": {
    "id": "scripts.analyze-test-results.TestFailure",
    "name": "TestFailure",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/scripts/analyze-test-results.ts",
    "relative_path": "scripts/analyze-test-results.ts",
    "depends_on": [],
    "source_code": "interface TestFailure {\n  scenario: string;\n  step: string;\n  error: string;\n  category: 'critical' | 'high' | 'medium' | 'low' | 'expected';\n  rootCause?: string;\n  suggestedFix?: string;\n  priority?: 'P0' | 'P1' | 'P2' | 'P3';\n}",
    "start_line": 12,
    "end_line": 20,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface TestFailure",
    "component_id": "scripts.analyze-test-results.TestFailure"
  },
  "scripts.analyze-test-results.TestResult": {
    "id": "scripts.analyze-test-results.TestResult",
    "name": "TestResult",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/scripts/analyze-test-results.ts",
    "relative_path": "scripts/analyze-test-results.ts",
    "depends_on": [],
    "source_code": "interface TestResult {\n  scenario: string;\n  success: boolean;\n  duration: number;\n  failures: string[];\n}",
    "start_line": 22,
    "end_line": 27,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface TestResult",
    "component_id": "scripts.analyze-test-results.TestResult"
  },
  "scripts.analyze-test-results.AnalysisReport": {
    "id": "scripts.analyze-test-results.AnalysisReport",
    "name": "AnalysisReport",
    "component_type": "interface",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/scripts/analyze-test-results.ts",
    "relative_path": "scripts/analyze-test-results.ts",
    "depends_on": [
      "scripts.analyze-test-results.TestFailure"
    ],
    "source_code": "interface AnalysisReport {\n  timestamp: string;\n  totalTests: number;\n  passed: number;\n  failed: number;\n  passRate: number;\n  failures: TestFailure[];\n  summary: string;\n  recommendations: string[];\n}",
    "start_line": 29,
    "end_line": 38,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "interface",
    "base_classes": [],
    "class_name": null,
    "display_name": "interface AnalysisReport",
    "component_id": "scripts.analyze-test-results.AnalysisReport"
  },
  "scripts.analyze-test-results.parseTestResults": {
    "id": "scripts.analyze-test-results.parseTestResults",
    "name": "parseTestResults",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/scripts/analyze-test-results.ts",
    "relative_path": "scripts/analyze-test-results.ts",
    "depends_on": [
      "scripts.analyze-test-results.TestResult"
    ],
    "source_code": "function parseTestResults(logPath: string): TestResult[] {\n  if (!existsSync(logPath)) {\n    console.error(`Test log not found: ${logPath}`);\n    process.exit(1);\n  }\n\n  const logContent = readFileSync(logPath, 'utf-8');\n  const results: TestResult[] = [];\n\n  // Parse test output (assuming format from runner.ts)\n  const scenarioBlocks = logContent.split(' Running:').slice(1);\n\n  for (const block of scenarioBlocks) {\n    const lines = block.split('\\n');\n    const scenario = lines[0]?.trim() || 'Unknown';\n\n    const failures: string[] = [];\n    let success = true;\n\n    for (const line of lines) {\n      if (line.includes(' Step')) {\n        success = false;\n        failures.push(line.trim());\n      }\n    }\n\n    // Extract duration (rough estimate from timestamps)\n    const duration = 1000; // Placeholder\n\n    results.push({ scenario, success, duration, failures });\n  }\n\n  return results;\n}",
    "start_line": 43,
    "end_line": 76,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "logPath"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function parseTestResults",
    "component_id": "scripts.analyze-test-results.parseTestResults"
  },
  "scripts.analyze-test-results.categorizeFailures": {
    "id": "scripts.analyze-test-results.categorizeFailures",
    "name": "categorizeFailures",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/scripts/analyze-test-results.ts",
    "relative_path": "scripts/analyze-test-results.ts",
    "depends_on": [
      "scripts.analyze-test-results.TestFailure",
      "scripts.analyze-test-results.categorizeFailure",
      "scripts.analyze-test-results.TestResult"
    ],
    "source_code": "function categorizeFailures(results: TestResult[]): TestFailure[] {\n  const failures: TestFailure[] = [];\n\n  for (const result of results) {\n    if (!result.success) {\n      for (const failure of result.failures) {\n        const testFailure = categorizeFailure(result.scenario, failure);\n        failures.push(testFailure);\n      }\n    }\n  }\n\n  return failures;\n}",
    "start_line": 81,
    "end_line": 94,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "results"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function categorizeFailures",
    "component_id": "scripts.analyze-test-results.categorizeFailures"
  },
  "scripts.analyze-test-results.categorizeFailure": {
    "id": "scripts.analyze-test-results.categorizeFailure",
    "name": "categorizeFailure",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/scripts/analyze-test-results.ts",
    "relative_path": "scripts/analyze-test-results.ts",
    "depends_on": [
      "scripts.analyze-test-results.TestFailure",
      "scripts.analyze-test-results.extractStepNumber"
    ],
    "source_code": "function categorizeFailure(scenario: string, errorLine: string): TestFailure {\n  const failure: TestFailure = {\n    scenario,\n    step: extractStepNumber(errorLine),\n    error: errorLine,\n    category: 'medium',\n  };\n\n  // Pattern matching for known issues\n  if (errorLine.includes('workflow') || errorLine.includes('Invalid arguments for workflow')) {\n    failure.category = 'critical';\n    failure.priority = 'P0';\n    failure.rootCause = 'Workflow invocation pattern mismatch';\n    failure.suggestedFix = 'Use workflow.start() instead of scheduler.runAfter()';\n  } else if (errorLine.includes('Agent API unavailable') || errorLine.includes('Cannot connect to API')) {\n    failure.category = 'expected';\n    failure.rootCause = 'Missing LLM API keys (expected in test environment)';\n    failure.suggestedFix = 'Add OPENAI_API_KEY and GOOGLE_GENERATIVE_AI_API_KEY to environment';\n  } else if (errorLine.includes('No completed assessment') || errorLine.includes('Assessment not finalized')) {\n    failure.category = 'critical';\n    failure.priority = 'P0';\n    failure.rootCause = 'Assessment finalization workflow not triggered';\n    failure.suggestedFix = 'Fix workflow invocation + add auto-finalization trigger';\n  } else if (errorLine.includes('timeout') || errorLine.includes('Scenario timeout')) {\n    failure.category = 'high';\n    failure.priority = 'P1';\n    failure.rootCause = 'Test timeout (18s retry delays)';\n    failure.suggestedFix = 'Reduce timeout in test environment (18s  2s)';\n  } else if (errorLine.includes('Validator error') || errorLine.includes('Expected ID for table')) {\n    failure.category = 'low';\n    failure.priority = 'P2';\n    failure.rootCause = 'Invalid test ID format';\n    failure.suggestedFix = 'Use properly formatted Convex ID in test';\n  } else if (errorLine.includes('User not found')) {\n    failure.category = 'low';\n    failure.priority = 'P2';\n    failure.rootCause = 'Test setup issue (user not created)';\n    failure.suggestedFix = 'Verify test setup creates user before operations';\n  }\n\n  return failure;\n}",
    "start_line": 99,
    "end_line": 140,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "scenario",
      "errorLine"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function categorizeFailure",
    "component_id": "scripts.analyze-test-results.categorizeFailure"
  },
  "scripts.analyze-test-results.extractStepNumber": {
    "id": "scripts.analyze-test-results.extractStepNumber",
    "name": "extractStepNumber",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/scripts/analyze-test-results.ts",
    "relative_path": "scripts/analyze-test-results.ts",
    "depends_on": [],
    "source_code": "function extractStepNumber(errorLine: string): string {\n  const match = errorLine.match(/Step (\\d+)/);\n  return match ? `Step ${match[1]}` : 'Unknown step';\n}",
    "start_line": 145,
    "end_line": 148,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "errorLine"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function extractStepNumber",
    "component_id": "scripts.analyze-test-results.extractStepNumber"
  },
  "scripts.analyze-test-results.createGitHubIssue": {
    "id": "scripts.analyze-test-results.createGitHubIssue",
    "name": "createGitHubIssue",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/scripts/analyze-test-results.ts",
    "relative_path": "scripts/analyze-test-results.ts",
    "depends_on": [
      "scripts.analyze-test-results.TestFailure"
    ],
    "source_code": "async function createGitHubIssue(failure: TestFailure): Promise<void> {\n  if (failure.category === 'expected') {\n    // Don't create issues for expected failures\n    return;\n  }\n\n  const title = `[E2E] ${failure.scenario} - ${failure.step}`;\n  const body = `## Test Failure\n\n**Scenario**: ${failure.scenario}\n**Step**: ${failure.step}\n**Category**: ${failure.category}\n**Priority**: ${failure.priority || 'P2'}\n\n### Error\n\\`\\`\\`\n${failure.error}\n\\`\\`\\`\n\n### Root Cause\n${failure.rootCause || 'To be investigated'}\n\n### Suggested Fix\n${failure.suggestedFix || 'To be determined'}\n\n### Automation\nThis issue was automatically created by the E2E test analysis tool.\n\n---\n**Auto-generated** on ${new Date().toISOString()}`;\n\n  const labels = [\n    'e2e-test',\n    failure.priority || 'P2',\n    failure.category === 'critical' ? 'bug' : 'enhancement',\n  ];\n\n  try {\n    // Use GitHub CLI to create issue\n    const labelArgs = labels.map(l => `--label \"${l}\"`).join(' ');\n    const command = `gh issue create --title \"${title}\" --body \"${body.replace(/\"/g, '\\\\\"')}\" ${labelArgs}`;\n\n    execSync(command, { stdio: 'inherit' });\n    console.log(` Created issue: ${title}`);\n  } catch (error) {\n    console.error(` Failed to create issue: ${error}`);\n  }\n}",
    "start_line": 153,
    "end_line": 200,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "failure"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function createGitHubIssue",
    "component_id": "scripts.analyze-test-results.createGitHubIssue"
  },
  "scripts.analyze-test-results.generateReport": {
    "id": "scripts.analyze-test-results.generateReport",
    "name": "generateReport",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/scripts/analyze-test-results.ts",
    "relative_path": "scripts/analyze-test-results.ts",
    "depends_on": [
      "scripts.analyze-test-results.TestFailure",
      "scripts.analyze-test-results.TestResult",
      "scripts.analyze-test-results.AnalysisReport"
    ],
    "source_code": "function generateReport(results: TestResult[], failures: TestFailure[]): AnalysisReport {\n  const totalTests = results.length;\n  const passed = results.filter(r => r.success).length;\n  const failed = totalTests - passed;\n  const passRate = (passed / totalTests) * 100;\n\n  // Count by category\n  const critical = failures.filter(f => f.category === 'critical').length;\n  const high = failures.filter(f => f.category === 'high').length;\n  const expected = failures.filter(f => f.category === 'expected').length;\n\n  const summary = `\nE2E Test Analysis Summary\n========================\n\nTotal Tests: ${totalTests}\nPassed: ${passed} (${passRate.toFixed(1)}%)\nFailed: ${failed}\n\nFailures by Category:\n- Critical (P0): ${critical}\n- High (P1): ${high}\n- Expected: ${expected}\n\n${critical > 0 ? '  CRITICAL ISSUES FOUND - Immediate action required' : ''}\n${expected > 0 ? `  ${expected} expected failures (missing API keys)` : ''}\n`;\n\n  const recommendations: string[] = [];\n\n  if (critical > 0) {\n    recommendations.push('Fix critical workflow invocation bugs before deploying to production');\n  }\n  if (high > 0) {\n    recommendations.push('Reduce test timeouts to improve test execution speed');\n  }\n  if (expected > 0) {\n    recommendations.push('Add API keys to CI/CD environment for full test coverage');\n  }\n  if (passRate < 90) {\n    recommendations.push('Pass rate below 90% - prioritize test fixes in next sprint');\n  }\n\n  return {\n    timestamp: new Date().toISOString(),\n    totalTests,\n    passed,\n    failed,\n    passRate,\n    failures,\n    summary,\n    recommendations,\n  };\n}",
    "start_line": 205,
    "end_line": 258,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "results",
      "failures"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function generateReport",
    "component_id": "scripts.analyze-test-results.generateReport"
  },
  "scripts.analyze-test-results.saveReport": {
    "id": "scripts.analyze-test-results.saveReport",
    "name": "saveReport",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/scripts/analyze-test-results.ts",
    "relative_path": "scripts/analyze-test-results.ts",
    "depends_on": [
      "scripts.analyze-test-results.AnalysisReport"
    ],
    "source_code": "function saveReport(report: AnalysisReport, outputPath: string): void {\n  writeFileSync(outputPath, JSON.stringify(report, null, 2));\n  console.log(`\\n Report saved to: ${outputPath}`);\n}",
    "start_line": 263,
    "end_line": 266,
    "has_docstring": false,
    "docstring": "",
    "parameters": [
      "report",
      "outputPath"
    ],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "function saveReport",
    "component_id": "scripts.analyze-test-results.saveReport"
  },
  "scripts.analyze-test-results.main": {
    "id": "scripts.analyze-test-results.main",
    "name": "main",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/scripts/analyze-test-results.ts",
    "relative_path": "scripts/analyze-test-results.ts",
    "depends_on": [
      "scripts.analyze-test-results.createGitHubIssue",
      "scripts.analyze-test-results.parseTestResults",
      "scripts.analyze-test-results.saveReport",
      "scripts.analyze-test-results.generateReport",
      "scripts.analyze-test-results.categorizeFailures"
    ],
    "source_code": "async function main() {\n  const args = process.argv.slice(2);\n  const logPath = args[0] || 'test-results/e2e-output.log';\n  const outputPath = args[1] || 'test-results/analysis-report.json';\n  const createIssues = args.includes('--create-issues');\n\n  console.log('E2E Test Analysis Tool\\n');\n\n  // Parse test results\n  console.log(`Reading test results from: ${logPath}`);\n  const results = parseTestResults(logPath);\n\n  // Categorize failures\n  console.log('Categorizing failures...');\n  const failures = categorizeFailures(results);\n\n  // Generate report\n  console.log('Generating analysis report...');\n  const report = generateReport(results, failures);\n\n  // Print summary\n  console.log(report.summary);\n\n  if (report.recommendations.length > 0) {\n    console.log('\\nRecommendations:');\n    report.recommendations.forEach((rec, i) => {\n      console.log(`${i + 1}. ${rec}`);\n    });\n  }\n\n  // Save report\n  saveReport(report, outputPath);\n\n  // Create GitHub issues (optional)\n  if (createIssues) {\n    console.log('\\nCreating GitHub issues for failures...\\n');\n    for (const failure of failures) {\n      await createGitHubIssue(failure);\n    }\n  } else {\n    console.log('\\nSkipping GitHub issue creation (use --create-issues to enable)');\n  }\n\n  // Exit with error if critical failures found\n  const criticalCount = failures.filter(f => f.category === 'critical').length;\n  if (criticalCount > 0) {\n    console.error(`\\n ${criticalCount} critical failure(s) found`);\n    process.exit(1);\n  }\n}",
    "start_line": 271,
    "end_line": 320,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "function",
    "base_classes": null,
    "class_name": null,
    "display_name": "async function main",
    "component_id": "scripts.analyze-test-results.main"
  },
  "vite.config.defineConfig": {
    "id": "vite.config.defineConfig",
    "name": "defineConfig",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/vite.config.ts",
    "relative_path": "vite.config.ts",
    "depends_on": [
      "vite.config.defineConfig"
    ],
    "source_code": "export default defineConfig({\n  envDir: path.resolve(__dirname, \"..\"),\n  plugins: [react()],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(__dirname, \"./ui\"),\n      \"@twilio-component\": path.resolve(\n        __dirname,\n        \"./node_modules/@convex-dev/twilio/dist/component\"\n      ),\n    },\n  },\n});",
    "start_line": 6,
    "end_line": 18,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "export_default_call",
    "base_classes": null,
    "class_name": null,
    "display_name": "export default defineConfig(...)",
    "component_id": "vite.config.defineConfig"
  },
  "vitest.config.defineConfig": {
    "id": "vitest.config.defineConfig",
    "name": "defineConfig",
    "component_type": "function",
    "file_path": "/Users/amadad/Projects/givecare/give-care-app/vitest.config.ts",
    "relative_path": "vitest.config.ts",
    "depends_on": [
      "vitest.config.defineConfig"
    ],
    "source_code": "export default defineConfig({\n  test: {\n    globals: true,\n    environment: 'edge-runtime',\n    include: ['tests/**/*.test.ts'],\n    // Don't exclude _generated - we need it for imports\n    exclude: ['node_modules', 'tests/**/*.eval.ts'],\n    env: {\n      // Pass environment variables to test environment\n      GOOGLE_GENERATIVE_AI_API_KEY: process.env.GOOGLE_GENERATIVE_AI_API_KEY || '',\n      OPENAI_API_KEY: process.env.OPENAI_API_KEY || '',\n      GEMINI_API_KEY: process.env.GEMINI_API_KEY || process.env.GOOGLE_GENERATIVE_AI_API_KEY || '',\n    },\n    server: {\n      deps: { inline: ['convex-test'] },\n      fs: {\n        // Explicitly allow Vite to access _generated during import.meta.glob evaluation\n        allow: ['.', '../node_modules', './convex/_generated']\n      }\n    },\n    // Coverage configuration\n    coverage: {\n      provider: 'v8',\n      reporter: ['text', 'json', 'html', 'lcov'],\n      reportsDirectory: './test-results/coverage',\n      exclude: [\n        'node_modules/**',\n        'convex/_generated/**',\n        'tests/**',\n        '*.config.ts',\n        '*.config.js',\n        'scripts/**',\n        'dist/**',\n        '.convex/**',\n      ],\n      include: ['convex/**/*.ts'],\n      // Thresholds (fail tests if coverage below these values)\n      thresholds: {\n        lines: 60,\n        functions: 60,\n        branches: 50,\n        statements: 60,\n      },\n    },\n    // Parallel execution for faster tests\n    pool: 'threads',\n    poolOptions: {\n      threads: {\n        singleThread: false,\n        maxThreads: 4, // Run up to 4 test files in parallel\n      },\n    },\n    // Test output\n    outputFile: {\n      json: './test-results/summary.json',\n    },\n  },\n  resolve: {\n    alias: {\n      '~': path.resolve(__dirname, './convex'),\n    },\n  },\n});",
    "start_line": 8,
    "end_line": 70,
    "has_docstring": false,
    "docstring": "",
    "parameters": [],
    "node_type": "export_default_call",
    "base_classes": null,
    "class_name": null,
    "display_name": "export default defineConfig(...)",
    "component_id": "vitest.config.defineConfig"
  }
}